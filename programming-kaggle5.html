<!DOCTYPE html>
<html>
<head>

    <!-- Document Settings -->
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

    <!-- Base Meta -->
    <!-- dynamically fixing the title for tag/author pages -->



    <title>캐글 (5) <br> 메타 데이터를 이용한 <br> 데이터 관찰 및 준비</title>
    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!-- Styles'n'Scripts -->
    <link rel="stylesheet" type="text/css" href="/assets/built/screen.css" />
    <link rel="stylesheet" type="text/css" href="/assets/built/screen.edited.css" />
    <link rel="stylesheet" type="text/css" href="/assets/built/syntax.css" />
    
    <!-- custom.css -->
    <link rel="stylesheet" type="text/css" href="/assets/built/custom.css" />
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">

    <!-- 웹폰트 추가-->
    <link rel="stylesheet" href="https://fonts.googleapis.com/earlyaccess/nanumgothic.css">

    <!-- syntax.css 추가-->
    <link rel="stylesheet" type="text/css" href="/assets/built/syntax.css" />

    <!-- highlight.js -->
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css">
    <style>.hljs { background: none; }</style>

    <!--[if IE]>
        <style>
            p, ol, ul{
                width: 100%;
            }
            blockquote{
                width: 100%;
            }
        </style>
    <![endif]-->
    
    <!-- This tag outputs SEO meta+structured data and other important settings -->
    <meta name="description" content="데이터 사이언티스트를 꿈꾸는 블로그입니다." />
    <link rel="shortcut icon" href="https://keonju2.github.io/assets/built/images/favicon.jpg" type="image/png" />
    <link rel="canonical" href="https://keonju2.github.io/programming-kaggle5" />
    <meta name="referrer" content="no-referrer-when-downgrade" />

     <!--title below is coming from _includes/dynamic_title-->
    <meta property="og:site_name" content="주건나's Blog" />
    <meta property="og:type" content="website" />
    <meta property="og:title" content="캐글 (5) <br> 메타 데이터를 이용한 <br> 데이터 관찰 및 준비" />
    <meta property="og:description" content="kaggle 관련 글 캐글 (1) Simple Matplotlib &amp; Visualization Tips 공부하기 캐글 (2) 타이타닉 튜토리얼 1,2 공부하기 캐글 (3) 타이타닉 생존자 EDA 부터 분류까지 캐글 (4) 타이타닉 생존자 앙상블과 스태킹까지 캐글 (5) 메타 데이터를 이용한 데이터 관찰 및 준비 https://www.kaggle.com/arthurtok/introduction-to-ensembling-stacking-in-python 캐글의 Porto Seguro’s Safe Driver Prediction 데이터를 통해 메타 데이터를" />
    <meta property="og:url" content="https://keonju2.github.io/programming-kaggle5" />
    <meta property="og:image" content="https://keonju2.github.io/assets/built/images/kaggle-logo.png" />
    <meta property="article:publisher" content="https://www.facebook.com/monkeykeonju" />
    <meta property="article:author" content="https://www.facebook.com/monkeykeonju" />
    <meta property="article:published_time" content="2021-11-22T21:00:00+09:00" />
    <meta property="article:modified_time" content="2021-11-22T21:00:00+09:00" />
    <meta property="article:tag" content="Programming" />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="캐글 (5) <br> 메타 데이터를 이용한 <br> 데이터 관찰 및 준비" />
    <meta name="twitter:description" content="kaggle 관련 글 캐글 (1) Simple Matplotlib &amp; Visualization Tips 공부하기 캐글 (2) 타이타닉 튜토리얼 1,2 공부하기 캐글 (3) 타이타닉 생존자 EDA 부터 분류까지 캐글 (4) 타이타닉 생존자 앙상블과 스태킹까지 캐글 (5) 메타 데이터를 이용한 데이터 관찰 및 준비 https://www.kaggle.com/arthurtok/introduction-to-ensembling-stacking-in-python 캐글의 Porto Seguro’s Safe Driver Prediction 데이터를 통해 메타 데이터를" />
    <meta name="twitter:url" content="https://keonju2.github.io/" />
    <meta name="twitter:image" content="https://keonju2.github.io/assets/built/images/kaggle-logo.png" />
    <meta name="twitter:label1" content="Written by" />
    <meta name="twitter:data1" content="주건나's Blog" />
    <meta name="twitter:label2" content="Filed under" />
    <meta name="twitter:data2" content="Programming" />
    <meta name="twitter:site" content="@" />
    <meta name="twitter:creator" content="@" />
    <meta property="og:image:width" content="1400" />
    <meta property="og:image:height" content="933" />

    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Website",
    "publisher": {
        "@type": "Organization",
        "name": "주건나's Blog",
        "logo": "https://keonju2.github.io/"
    },
    "url": "https://keonju2.github.io/programming-kaggle5",
    "image": {
        "@type": "ImageObject",
        "url": "https://keonju2.github.io/assets/built/images/kaggle-logo.png",
        "width": 2000,
        "height": 666
    },
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "https://keonju2.github.io/programming-kaggle5"
    },
    "description": "kaggle 관련 글 캐글 (1) Simple Matplotlib &amp; Visualization Tips 공부하기 캐글 (2) 타이타닉 튜토리얼 1,2 공부하기 캐글 (3) 타이타닉 생존자 EDA 부터 분류까지 캐글 (4) 타이타닉 생존자 앙상블과 스태킹까지 캐글 (5) 메타 데이터를 이용한 데이터 관찰 및 준비 https://www.kaggle.com/arthurtok/introduction-to-ensembling-stacking-in-python 캐글의 Porto Seguro’s Safe Driver Prediction 데이터를 통해 메타 데이터를"
}
    </script>

    <!-- <script type="text/javascript" src="https://demo.ghost.io/public/ghost-sdk.min.js?v=724281a32e"></script>
    <script type="text/javascript">
    ghost.init({
    	clientId: "ghost-frontend",
    	clientSecret: "f84a07a72b17"
    });
    </script> -->

    <meta name="generator" content="Jekyll 3.6.2" />
    <link rel="alternate" type="application/rss+xml" title="캐글 (5) <br> 메타 데이터를 이용한 <br> 데이터 관찰 및 준비" href="/feed.xml" />


</head>
<body class="post-template">

    <div class="site-wrapper">
        <!-- All the main content gets inserted here, index.hbs, post.hbs, etc -->
        <!-- default -->

<!-- The tag above means: insert everything in this file
into the {body} of the default.hbs template -->

<header class="site-header outer">
    <div class="inner">
        <nav class="site-nav">
    <div class="site-nav-left">
        
            
                <a class="site-nav-logo" href="https://keonju2.github.io/">주건나's Blog</a>
            
        
        
            <ul class="nav" role="menu">
    <li class="nav-home" role="menuitem"><a href="/">Home</a></li>
    <li class="nav-about" role="menuitem"><a href="/about/">About</a></li>
    <li class="nav-R" role="menuitem"><a href="/tag/programming/">프로그래밍 언어</a></li>
    <li class="nav-python" role="menuitem"><a href="/tag/activity/">대외활동</a></li>
    <li class="nav-python" role="menuitem"><a href="/tag/license/">자격증</a></li>
    <li class="nav-python" role="menuitem"><a href="/tag/study/">이론 공부</a></li>
    <li class="nav-archive" role="menuitem">
        <a href="/archive.html">All Posts</a>
    </li>
    <li class="nav-archive" role="menuitem">
        <a href="/author_archive.html">Tag별 Posts</a>
    </li>
</ul>
        
    </div>
    <div class="site-nav-right">
        <div class="social-links">
            
                <a class="social-link social-link-fb" href="https://facebook.com/monkeykeonju" target="_blank" rel="noopener"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M19 6h5V0h-5c-3.86 0-7 3.14-7 7v3H8v6h4v16h6V16h5l1-6h-6V7c0-.542.458-1 1-1z"/></svg>
</a>
            
            
        </div>
        
            <a class="subscribe-button" href="#subscribe">Search</a>
        
    </div>
</nav>

    </div>
</header>

<!-- Everything inside the #post tags pulls data from the post -->
<!-- #post -->

<main id="site-main" class="site-main outer" role="main">
    <div class="inner">

        <script type="text/x-mathjax-config">
            MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
            </script>
            <script type="text/javascript" src="http://cdn.mathjax.org/math...">
            </script>
        
        <article class="post-full  tag-programming post tag-kaggle ">

            <header class="post-full-header">
                <section class="post-full-meta">
                    <time class="post-full-meta-date" datetime="22 November 2021">22 November 2021</time>
                    
                        <span class="date-divider">/</span>
                        
                            
                               <a href='/tag/programming/'>PROGRAMMING</a>
                            
                        
                    
                </section>
                <h1 class="post-full-title">캐글 (5) <br> 메타 데이터를 이용한 <br> 데이터 관찰 및 준비</h1>
            </header>
            <!--
            
            <figure class="post-full-image" style="background-image: url(/assets/built/images/kaggle-logo.png)">
            </figure>
            
             -->
            <section class="post-full-content">
                <div class="kg-card-markdown">
                    <p><span class="table-of-contents-list">kaggle 관련 글</span></p>
<ul class="table-of-contents-list">
    <li><a href="./programming-kaggle1">캐글 (1) Simple Matplotlib &amp; Visualization Tips 공부하기</a></li>
    <li><a href="./programming-kaggle2">캐글 (2) 타이타닉 튜토리얼 1,2 공부하기</a></li>
    <li><a href="./programming-kaggle3">캐글 (3) 타이타닉 생존자 EDA 부터 분류까지</a></li>
    <li><a href="./programming-kaggle4">캐글 (4) 타이타닉 생존자 앙상블과 스태킹까지</a></li>
    <li><a href="./programming-kaggle5">캐글 (5) 메타 데이터를 이용한 데이터 관찰 및 준비</a></li>
</ul>

<p><a href="https://www.kaggle.com/arthurtok/introduction-to-ensembling-stacking-in-python">https://www.kaggle.com/arthurtok/introduction-to-ensembling-stacking-in-python</a></p>

<p>캐글의 Porto Seguro’s Safe Driver Prediction 데이터를 통해 메타 데이터를 이용하여 데이터 분석 준비하는 방법을 필사했습니다.</p>

<ol>
  <li>Visual inspection of your data</li>
  <li>Defining the metadata</li>
  <li>Descriptive statistics</li>
  <li>Handling imbalanced classes</li>
  <li>Data quality checks</li>
  <li>Exploratory data visualization</li>
  <li>Feature engineering</li>
  <li>Feature selection</li>
  <li>Feature scaling</li>
</ol>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">## 패키지 설치
</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="n">sns</span>
<span class="kn">from</span> <span class="nn">sklearn.impute</span> <span class="kn">import</span> <span class="n">SimpleImputer</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">PolynomialFeatures</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="kn">from</span> <span class="nn">sklearn.feature_selection</span> <span class="kn">import</span> <span class="n">VarianceThreshold</span>
<span class="kn">from</span> <span class="nn">sklearn.feature_selection</span> <span class="kn">import</span> <span class="n">SelectFromModel</span>
<span class="kn">from</span> <span class="nn">sklearn.utils</span> <span class="kn">import</span> <span class="n">shuffle</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestClassifier</span>

<span class="n">pd</span><span class="p">.</span><span class="n">set_option</span><span class="p">(</span><span class="s">'display.max_columns'</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">train</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">'train.csv'</span><span class="p">)</span>
<span class="n">test</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">'test.csv'</span><span class="p">)</span>
</code></pre></div></div>

<h2 id="데이터-확인하기">데이터 확인하기</h2>

<p>유사한 그룹에 속하는 feature은 태그가 지정됩니다. (ind,reg,car,calc)<br />
feature 이름에서 bin은 이진 특성을, cat은 범주형 특성입니다.<br />
그 외에는 연속 또는 순서형 특성입니다.<br />
-1은 결측값입니다.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">train</span><span class="p">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>target</th>
      <th>ps_ind_01</th>
      <th>ps_ind_02_cat</th>
      <th>ps_ind_03</th>
      <th>ps_ind_04_cat</th>
      <th>ps_ind_05_cat</th>
      <th>ps_ind_06_bin</th>
      <th>ps_ind_07_bin</th>
      <th>ps_ind_08_bin</th>
      <th>ps_ind_09_bin</th>
      <th>ps_ind_10_bin</th>
      <th>ps_ind_11_bin</th>
      <th>ps_ind_12_bin</th>
      <th>ps_ind_13_bin</th>
      <th>ps_ind_14</th>
      <th>ps_ind_15</th>
      <th>ps_ind_16_bin</th>
      <th>ps_ind_17_bin</th>
      <th>ps_ind_18_bin</th>
      <th>ps_reg_01</th>
      <th>ps_reg_02</th>
      <th>ps_reg_03</th>
      <th>ps_car_01_cat</th>
      <th>ps_car_02_cat</th>
      <th>ps_car_03_cat</th>
      <th>ps_car_04_cat</th>
      <th>ps_car_05_cat</th>
      <th>ps_car_06_cat</th>
      <th>ps_car_07_cat</th>
      <th>ps_car_08_cat</th>
      <th>ps_car_09_cat</th>
      <th>ps_car_10_cat</th>
      <th>ps_car_11_cat</th>
      <th>ps_car_11</th>
      <th>ps_car_12</th>
      <th>ps_car_13</th>
      <th>ps_car_14</th>
      <th>ps_car_15</th>
      <th>ps_calc_01</th>
      <th>ps_calc_02</th>
      <th>ps_calc_03</th>
      <th>ps_calc_04</th>
      <th>ps_calc_05</th>
      <th>ps_calc_06</th>
      <th>ps_calc_07</th>
      <th>ps_calc_08</th>
      <th>ps_calc_09</th>
      <th>ps_calc_10</th>
      <th>ps_calc_11</th>
      <th>ps_calc_12</th>
      <th>ps_calc_13</th>
      <th>ps_calc_14</th>
      <th>ps_calc_15_bin</th>
      <th>ps_calc_16_bin</th>
      <th>ps_calc_17_bin</th>
      <th>ps_calc_18_bin</th>
      <th>ps_calc_19_bin</th>
      <th>ps_calc_20_bin</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>7</td>
      <td>0</td>
      <td>2</td>
      <td>2</td>
      <td>5</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>11</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0.7</td>
      <td>0.2</td>
      <td>0.718070</td>
      <td>10</td>
      <td>1</td>
      <td>-1</td>
      <td>0</td>
      <td>1</td>
      <td>4</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>12</td>
      <td>2</td>
      <td>0.400000</td>
      <td>0.883679</td>
      <td>0.370810</td>
      <td>3.605551</td>
      <td>0.6</td>
      <td>0.5</td>
      <td>0.2</td>
      <td>3</td>
      <td>1</td>
      <td>10</td>
      <td>1</td>
      <td>10</td>
      <td>1</td>
      <td>5</td>
      <td>9</td>
      <td>1</td>
      <td>5</td>
      <td>8</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>9</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>7</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0.8</td>
      <td>0.4</td>
      <td>0.766078</td>
      <td>11</td>
      <td>1</td>
      <td>-1</td>
      <td>0</td>
      <td>-1</td>
      <td>11</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>1</td>
      <td>19</td>
      <td>3</td>
      <td>0.316228</td>
      <td>0.618817</td>
      <td>0.388716</td>
      <td>2.449490</td>
      <td>0.3</td>
      <td>0.1</td>
      <td>0.3</td>
      <td>2</td>
      <td>1</td>
      <td>9</td>
      <td>5</td>
      <td>8</td>
      <td>1</td>
      <td>7</td>
      <td>3</td>
      <td>1</td>
      <td>1</td>
      <td>9</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>13</td>
      <td>0</td>
      <td>5</td>
      <td>4</td>
      <td>9</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>12</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>-1.000000</td>
      <td>7</td>
      <td>1</td>
      <td>-1</td>
      <td>0</td>
      <td>-1</td>
      <td>14</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>1</td>
      <td>60</td>
      <td>1</td>
      <td>0.316228</td>
      <td>0.641586</td>
      <td>0.347275</td>
      <td>3.316625</td>
      <td>0.5</td>
      <td>0.7</td>
      <td>0.1</td>
      <td>2</td>
      <td>2</td>
      <td>9</td>
      <td>1</td>
      <td>8</td>
      <td>2</td>
      <td>7</td>
      <td>4</td>
      <td>2</td>
      <td>7</td>
      <td>7</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>16</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>8</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0.9</td>
      <td>0.2</td>
      <td>0.580948</td>
      <td>7</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>11</td>
      <td>1</td>
      <td>1</td>
      <td>3</td>
      <td>1</td>
      <td>104</td>
      <td>1</td>
      <td>0.374166</td>
      <td>0.542949</td>
      <td>0.294958</td>
      <td>2.000000</td>
      <td>0.6</td>
      <td>0.9</td>
      <td>0.1</td>
      <td>2</td>
      <td>4</td>
      <td>7</td>
      <td>1</td>
      <td>8</td>
      <td>4</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>4</td>
      <td>9</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>17</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>9</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0.7</td>
      <td>0.6</td>
      <td>0.840759</td>
      <td>11</td>
      <td>1</td>
      <td>-1</td>
      <td>0</td>
      <td>-1</td>
      <td>14</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>1</td>
      <td>82</td>
      <td>3</td>
      <td>0.316070</td>
      <td>0.565832</td>
      <td>0.365103</td>
      <td>2.000000</td>
      <td>0.4</td>
      <td>0.6</td>
      <td>0.0</td>
      <td>2</td>
      <td>2</td>
      <td>6</td>
      <td>3</td>
      <td>10</td>
      <td>2</td>
      <td>12</td>
      <td>3</td>
      <td>1</td>
      <td>1</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">train</span><span class="p">.</span><span class="n">tail</span><span class="p">()</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>target</th>
      <th>ps_ind_01</th>
      <th>ps_ind_02_cat</th>
      <th>ps_ind_03</th>
      <th>ps_ind_04_cat</th>
      <th>ps_ind_05_cat</th>
      <th>ps_ind_06_bin</th>
      <th>ps_ind_07_bin</th>
      <th>ps_ind_08_bin</th>
      <th>ps_ind_09_bin</th>
      <th>ps_ind_10_bin</th>
      <th>ps_ind_11_bin</th>
      <th>ps_ind_12_bin</th>
      <th>ps_ind_13_bin</th>
      <th>ps_ind_14</th>
      <th>ps_ind_15</th>
      <th>ps_ind_16_bin</th>
      <th>ps_ind_17_bin</th>
      <th>ps_ind_18_bin</th>
      <th>ps_reg_01</th>
      <th>ps_reg_02</th>
      <th>ps_reg_03</th>
      <th>ps_car_01_cat</th>
      <th>ps_car_02_cat</th>
      <th>ps_car_03_cat</th>
      <th>ps_car_04_cat</th>
      <th>ps_car_05_cat</th>
      <th>ps_car_06_cat</th>
      <th>ps_car_07_cat</th>
      <th>ps_car_08_cat</th>
      <th>ps_car_09_cat</th>
      <th>ps_car_10_cat</th>
      <th>ps_car_11_cat</th>
      <th>ps_car_11</th>
      <th>ps_car_12</th>
      <th>ps_car_13</th>
      <th>ps_car_14</th>
      <th>ps_car_15</th>
      <th>ps_calc_01</th>
      <th>ps_calc_02</th>
      <th>ps_calc_03</th>
      <th>ps_calc_04</th>
      <th>ps_calc_05</th>
      <th>ps_calc_06</th>
      <th>ps_calc_07</th>
      <th>ps_calc_08</th>
      <th>ps_calc_09</th>
      <th>ps_calc_10</th>
      <th>ps_calc_11</th>
      <th>ps_calc_12</th>
      <th>ps_calc_13</th>
      <th>ps_calc_14</th>
      <th>ps_calc_15_bin</th>
      <th>ps_calc_16_bin</th>
      <th>ps_calc_17_bin</th>
      <th>ps_calc_18_bin</th>
      <th>ps_calc_19_bin</th>
      <th>ps_calc_20_bin</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>595207</th>
      <td>1488013</td>
      <td>0</td>
      <td>3</td>
      <td>1</td>
      <td>10</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>13</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0.5</td>
      <td>0.3</td>
      <td>0.692820</td>
      <td>10</td>
      <td>1</td>
      <td>-1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>31</td>
      <td>3</td>
      <td>0.374166</td>
      <td>0.684631</td>
      <td>0.385487</td>
      <td>2.645751</td>
      <td>0.4</td>
      <td>0.5</td>
      <td>0.3</td>
      <td>3</td>
      <td>0</td>
      <td>9</td>
      <td>0</td>
      <td>9</td>
      <td>1</td>
      <td>12</td>
      <td>4</td>
      <td>1</td>
      <td>9</td>
      <td>6</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>595208</th>
      <td>1488016</td>
      <td>0</td>
      <td>5</td>
      <td>1</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>6</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0.9</td>
      <td>0.7</td>
      <td>1.382027</td>
      <td>9</td>
      <td>1</td>
      <td>-1</td>
      <td>0</td>
      <td>-1</td>
      <td>15</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>1</td>
      <td>63</td>
      <td>2</td>
      <td>0.387298</td>
      <td>0.972145</td>
      <td>-1.000000</td>
      <td>3.605551</td>
      <td>0.2</td>
      <td>0.2</td>
      <td>0.0</td>
      <td>2</td>
      <td>4</td>
      <td>8</td>
      <td>6</td>
      <td>8</td>
      <td>2</td>
      <td>12</td>
      <td>4</td>
      <td>1</td>
      <td>3</td>
      <td>8</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>595209</th>
      <td>1488017</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>10</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>12</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0.9</td>
      <td>0.2</td>
      <td>0.659071</td>
      <td>7</td>
      <td>1</td>
      <td>-1</td>
      <td>0</td>
      <td>-1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>1</td>
      <td>31</td>
      <td>3</td>
      <td>0.397492</td>
      <td>0.596373</td>
      <td>0.398748</td>
      <td>1.732051</td>
      <td>0.4</td>
      <td>0.0</td>
      <td>0.3</td>
      <td>3</td>
      <td>2</td>
      <td>7</td>
      <td>4</td>
      <td>8</td>
      <td>0</td>
      <td>10</td>
      <td>3</td>
      <td>2</td>
      <td>2</td>
      <td>6</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>595210</th>
      <td>1488021</td>
      <td>0</td>
      <td>5</td>
      <td>2</td>
      <td>3</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>12</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0.9</td>
      <td>0.4</td>
      <td>0.698212</td>
      <td>11</td>
      <td>1</td>
      <td>-1</td>
      <td>0</td>
      <td>-1</td>
      <td>11</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>1</td>
      <td>101</td>
      <td>3</td>
      <td>0.374166</td>
      <td>0.764434</td>
      <td>0.384968</td>
      <td>3.162278</td>
      <td>0.0</td>
      <td>0.7</td>
      <td>0.0</td>
      <td>4</td>
      <td>0</td>
      <td>9</td>
      <td>4</td>
      <td>9</td>
      <td>2</td>
      <td>11</td>
      <td>4</td>
      <td>1</td>
      <td>4</td>
      <td>2</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>595211</th>
      <td>1488027</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>8</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>7</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0.1</td>
      <td>0.2</td>
      <td>-1.000000</td>
      <td>7</td>
      <td>0</td>
      <td>-1</td>
      <td>0</td>
      <td>-1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>2</td>
      <td>1</td>
      <td>34</td>
      <td>2</td>
      <td>0.400000</td>
      <td>0.932649</td>
      <td>0.378021</td>
      <td>3.741657</td>
      <td>0.4</td>
      <td>0.0</td>
      <td>0.5</td>
      <td>2</td>
      <td>3</td>
      <td>10</td>
      <td>4</td>
      <td>10</td>
      <td>2</td>
      <td>5</td>
      <td>4</td>
      <td>4</td>
      <td>3</td>
      <td>8</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">train</span><span class="p">.</span><span class="n">shape</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(595212, 59)
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">train</span><span class="p">.</span><span class="n">drop_duplicates</span><span class="p">()</span>
<span class="n">train</span><span class="p">.</span><span class="n">shape</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(595212, 59)
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">test</span><span class="p">.</span><span class="n">shape</span> 
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(892816, 58)
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">train</span><span class="p">.</span><span class="n">info</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 595212 entries, 0 to 595211
Data columns (total 59 columns):
 #   Column          Non-Null Count   Dtype  
---  ------          --------------   -----  
 0   id              595212 non-null  int64  
 1   target          595212 non-null  int64  
 2   ps_ind_01       595212 non-null  int64  
 3   ps_ind_02_cat   595212 non-null  int64  
 4   ps_ind_03       595212 non-null  int64  
 5   ps_ind_04_cat   595212 non-null  int64  
 6   ps_ind_05_cat   595212 non-null  int64  
 7   ps_ind_06_bin   595212 non-null  int64  
 8   ps_ind_07_bin   595212 non-null  int64  
 9   ps_ind_08_bin   595212 non-null  int64  
 10  ps_ind_09_bin   595212 non-null  int64  
 11  ps_ind_10_bin   595212 non-null  int64  
 12  ps_ind_11_bin   595212 non-null  int64  
 13  ps_ind_12_bin   595212 non-null  int64  
 14  ps_ind_13_bin   595212 non-null  int64  
 15  ps_ind_14       595212 non-null  int64  
 16  ps_ind_15       595212 non-null  int64  
 17  ps_ind_16_bin   595212 non-null  int64  
 18  ps_ind_17_bin   595212 non-null  int64  
 19  ps_ind_18_bin   595212 non-null  int64  
 20  ps_reg_01       595212 non-null  float64
 21  ps_reg_02       595212 non-null  float64
 22  ps_reg_03       595212 non-null  float64
 23  ps_car_01_cat   595212 non-null  int64  
 24  ps_car_02_cat   595212 non-null  int64  
 25  ps_car_03_cat   595212 non-null  int64  
 26  ps_car_04_cat   595212 non-null  int64  
 27  ps_car_05_cat   595212 non-null  int64  
 28  ps_car_06_cat   595212 non-null  int64  
 29  ps_car_07_cat   595212 non-null  int64  
 30  ps_car_08_cat   595212 non-null  int64  
 31  ps_car_09_cat   595212 non-null  int64  
 32  ps_car_10_cat   595212 non-null  int64  
 33  ps_car_11_cat   595212 non-null  int64  
 34  ps_car_11       595212 non-null  int64  
 35  ps_car_12       595212 non-null  float64
 36  ps_car_13       595212 non-null  float64
 37  ps_car_14       595212 non-null  float64
 38  ps_car_15       595212 non-null  float64
 39  ps_calc_01      595212 non-null  float64
 40  ps_calc_02      595212 non-null  float64
 41  ps_calc_03      595212 non-null  float64
 42  ps_calc_04      595212 non-null  int64  
 43  ps_calc_05      595212 non-null  int64  
 44  ps_calc_06      595212 non-null  int64  
 45  ps_calc_07      595212 non-null  int64  
 46  ps_calc_08      595212 non-null  int64  
 47  ps_calc_09      595212 non-null  int64  
 48  ps_calc_10      595212 non-null  int64  
 49  ps_calc_11      595212 non-null  int64  
 50  ps_calc_12      595212 non-null  int64  
 51  ps_calc_13      595212 non-null  int64  
 52  ps_calc_14      595212 non-null  int64  
 53  ps_calc_15_bin  595212 non-null  int64  
 54  ps_calc_16_bin  595212 non-null  int64  
 55  ps_calc_17_bin  595212 non-null  int64  
 56  ps_calc_18_bin  595212 non-null  int64  
 57  ps_calc_19_bin  595212 non-null  int64  
 58  ps_calc_20_bin  595212 non-null  int64  
dtypes: float64(10), int64(49)
memory usage: 267.9 MB
</code></pre></div></div>

<p>float인지 int인지 자료형을 알 수 있으며 null 대신 -1이 들어갔으므로 null이 없습니다.</p>

<h2 id="메타-데이터">메타 데이터</h2>

<p>메타데이터를 통해 데이터 정보를 저장합니다.<br />
변수의 타입과 feature의 특성을 저장합니다.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">data</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">train</span><span class="p">.</span><span class="n">columns</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">f</span> <span class="o">==</span> <span class="s">'target'</span><span class="p">:</span>
        <span class="n">role</span> <span class="o">=</span> <span class="s">'target'</span>
    <span class="k">elif</span> <span class="n">f</span> <span class="o">==</span> <span class="s">'id'</span><span class="p">:</span>
        <span class="n">role</span> <span class="o">=</span> <span class="s">'id'</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">role</span> <span class="o">=</span> <span class="s">'input'</span>
         
    <span class="k">if</span> <span class="s">'bin'</span> <span class="ow">in</span> <span class="n">f</span> <span class="ow">or</span> <span class="n">f</span> <span class="o">==</span> <span class="s">'target'</span><span class="p">:</span>
        <span class="n">level</span> <span class="o">=</span> <span class="s">'binary'</span>
    <span class="k">elif</span> <span class="s">'cat'</span> <span class="ow">in</span> <span class="n">f</span> <span class="ow">or</span> <span class="n">f</span> <span class="o">==</span> <span class="s">'id'</span><span class="p">:</span>
        <span class="n">level</span> <span class="o">=</span> <span class="s">'nominal'</span>
    <span class="k">elif</span> <span class="n">train</span><span class="p">[</span><span class="n">f</span><span class="p">].</span><span class="n">dtype</span> <span class="o">==</span> <span class="nb">float</span><span class="p">:</span>
        <span class="n">level</span> <span class="o">=</span> <span class="s">'interval'</span>
    <span class="k">elif</span> <span class="n">train</span><span class="p">[</span><span class="n">f</span><span class="p">].</span><span class="n">dtype</span> <span class="o">==</span> <span class="nb">int</span><span class="p">:</span>
        <span class="n">level</span> <span class="o">=</span> <span class="s">'ordinal'</span>
        
    <span class="n">keep</span> <span class="o">=</span> <span class="bp">True</span>
    <span class="k">if</span> <span class="n">f</span> <span class="o">==</span> <span class="s">'id'</span><span class="p">:</span>
        <span class="n">keep</span> <span class="o">=</span> <span class="bp">False</span>
    
    <span class="n">dtype</span> <span class="o">=</span> <span class="n">train</span><span class="p">[</span><span class="n">f</span><span class="p">].</span><span class="n">dtype</span>
    
    <span class="n">f_dict</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'varname'</span><span class="p">:</span> <span class="n">f</span><span class="p">,</span>
        <span class="s">'role'</span><span class="p">:</span> <span class="n">role</span><span class="p">,</span>
        <span class="s">'level'</span><span class="p">:</span> <span class="n">level</span><span class="p">,</span>
        <span class="s">'keep'</span><span class="p">:</span> <span class="n">keep</span><span class="p">,</span>
        <span class="s">'dtype'</span><span class="p">:</span> <span class="n">dtype</span>
    <span class="p">}</span>
    <span class="n">data</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">f_dict</span><span class="p">)</span>
    
<span class="n">meta</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s">'varname'</span><span class="p">,</span> <span class="s">'role'</span><span class="p">,</span> <span class="s">'level'</span><span class="p">,</span> <span class="s">'keep'</span><span class="p">,</span> <span class="s">'dtype'</span><span class="p">])</span>
<span class="n">meta</span><span class="p">.</span><span class="n">set_index</span><span class="p">(</span><span class="s">'varname'</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">meta</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>role</th>
      <th>level</th>
      <th>keep</th>
      <th>dtype</th>
    </tr>
    <tr>
      <th>varname</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>id</th>
      <td>id</td>
      <td>nominal</td>
      <td>False</td>
      <td>int64</td>
    </tr>
    <tr>
      <th>target</th>
      <td>target</td>
      <td>binary</td>
      <td>True</td>
      <td>int64</td>
    </tr>
    <tr>
      <th>ps_ind_01</th>
      <td>input</td>
      <td>binary</td>
      <td>True</td>
      <td>int64</td>
    </tr>
    <tr>
      <th>ps_ind_02_cat</th>
      <td>input</td>
      <td>nominal</td>
      <td>True</td>
      <td>int64</td>
    </tr>
    <tr>
      <th>ps_ind_03</th>
      <td>input</td>
      <td>nominal</td>
      <td>True</td>
      <td>int64</td>
    </tr>
    <tr>
      <th>ps_ind_04_cat</th>
      <td>input</td>
      <td>nominal</td>
      <td>True</td>
      <td>int64</td>
    </tr>
    <tr>
      <th>ps_ind_05_cat</th>
      <td>input</td>
      <td>nominal</td>
      <td>True</td>
      <td>int64</td>
    </tr>
    <tr>
      <th>ps_ind_06_bin</th>
      <td>input</td>
      <td>binary</td>
      <td>True</td>
      <td>int64</td>
    </tr>
    <tr>
      <th>ps_ind_07_bin</th>
      <td>input</td>
      <td>binary</td>
      <td>True</td>
      <td>int64</td>
    </tr>
    <tr>
      <th>ps_ind_08_bin</th>
      <td>input</td>
      <td>binary</td>
      <td>True</td>
      <td>int64</td>
    </tr>
    <tr>
      <th>ps_ind_09_bin</th>
      <td>input</td>
      <td>binary</td>
      <td>True</td>
      <td>int64</td>
    </tr>
    <tr>
      <th>ps_ind_10_bin</th>
      <td>input</td>
      <td>binary</td>
      <td>True</td>
      <td>int64</td>
    </tr>
    <tr>
      <th>ps_ind_11_bin</th>
      <td>input</td>
      <td>binary</td>
      <td>True</td>
      <td>int64</td>
    </tr>
    <tr>
      <th>ps_ind_12_bin</th>
      <td>input</td>
      <td>binary</td>
      <td>True</td>
      <td>int64</td>
    </tr>
    <tr>
      <th>ps_ind_13_bin</th>
      <td>input</td>
      <td>binary</td>
      <td>True</td>
      <td>int64</td>
    </tr>
    <tr>
      <th>ps_ind_14</th>
      <td>input</td>
      <td>binary</td>
      <td>True</td>
      <td>int64</td>
    </tr>
    <tr>
      <th>ps_ind_15</th>
      <td>input</td>
      <td>binary</td>
      <td>True</td>
      <td>int64</td>
    </tr>
    <tr>
      <th>ps_ind_16_bin</th>
      <td>input</td>
      <td>binary</td>
      <td>True</td>
      <td>int64</td>
    </tr>
    <tr>
      <th>ps_ind_17_bin</th>
      <td>input</td>
      <td>binary</td>
      <td>True</td>
      <td>int64</td>
    </tr>
    <tr>
      <th>ps_ind_18_bin</th>
      <td>input</td>
      <td>binary</td>
      <td>True</td>
      <td>int64</td>
    </tr>
    <tr>
      <th>ps_reg_01</th>
      <td>input</td>
      <td>interval</td>
      <td>True</td>
      <td>float64</td>
    </tr>
    <tr>
      <th>ps_reg_02</th>
      <td>input</td>
      <td>interval</td>
      <td>True</td>
      <td>float64</td>
    </tr>
    <tr>
      <th>ps_reg_03</th>
      <td>input</td>
      <td>interval</td>
      <td>True</td>
      <td>float64</td>
    </tr>
    <tr>
      <th>ps_car_01_cat</th>
      <td>input</td>
      <td>nominal</td>
      <td>True</td>
      <td>int64</td>
    </tr>
    <tr>
      <th>ps_car_02_cat</th>
      <td>input</td>
      <td>nominal</td>
      <td>True</td>
      <td>int64</td>
    </tr>
    <tr>
      <th>ps_car_03_cat</th>
      <td>input</td>
      <td>nominal</td>
      <td>True</td>
      <td>int64</td>
    </tr>
    <tr>
      <th>ps_car_04_cat</th>
      <td>input</td>
      <td>nominal</td>
      <td>True</td>
      <td>int64</td>
    </tr>
    <tr>
      <th>ps_car_05_cat</th>
      <td>input</td>
      <td>nominal</td>
      <td>True</td>
      <td>int64</td>
    </tr>
    <tr>
      <th>ps_car_06_cat</th>
      <td>input</td>
      <td>nominal</td>
      <td>True</td>
      <td>int64</td>
    </tr>
    <tr>
      <th>ps_car_07_cat</th>
      <td>input</td>
      <td>nominal</td>
      <td>True</td>
      <td>int64</td>
    </tr>
    <tr>
      <th>ps_car_08_cat</th>
      <td>input</td>
      <td>nominal</td>
      <td>True</td>
      <td>int64</td>
    </tr>
    <tr>
      <th>ps_car_09_cat</th>
      <td>input</td>
      <td>nominal</td>
      <td>True</td>
      <td>int64</td>
    </tr>
    <tr>
      <th>ps_car_10_cat</th>
      <td>input</td>
      <td>nominal</td>
      <td>True</td>
      <td>int64</td>
    </tr>
    <tr>
      <th>ps_car_11_cat</th>
      <td>input</td>
      <td>nominal</td>
      <td>True</td>
      <td>int64</td>
    </tr>
    <tr>
      <th>ps_car_11</th>
      <td>input</td>
      <td>nominal</td>
      <td>True</td>
      <td>int64</td>
    </tr>
    <tr>
      <th>ps_car_12</th>
      <td>input</td>
      <td>interval</td>
      <td>True</td>
      <td>float64</td>
    </tr>
    <tr>
      <th>ps_car_13</th>
      <td>input</td>
      <td>interval</td>
      <td>True</td>
      <td>float64</td>
    </tr>
    <tr>
      <th>ps_car_14</th>
      <td>input</td>
      <td>interval</td>
      <td>True</td>
      <td>float64</td>
    </tr>
    <tr>
      <th>ps_car_15</th>
      <td>input</td>
      <td>interval</td>
      <td>True</td>
      <td>float64</td>
    </tr>
    <tr>
      <th>ps_calc_01</th>
      <td>input</td>
      <td>interval</td>
      <td>True</td>
      <td>float64</td>
    </tr>
    <tr>
      <th>ps_calc_02</th>
      <td>input</td>
      <td>interval</td>
      <td>True</td>
      <td>float64</td>
    </tr>
    <tr>
      <th>ps_calc_03</th>
      <td>input</td>
      <td>interval</td>
      <td>True</td>
      <td>float64</td>
    </tr>
    <tr>
      <th>ps_calc_04</th>
      <td>input</td>
      <td>interval</td>
      <td>True</td>
      <td>int64</td>
    </tr>
    <tr>
      <th>ps_calc_05</th>
      <td>input</td>
      <td>interval</td>
      <td>True</td>
      <td>int64</td>
    </tr>
    <tr>
      <th>ps_calc_06</th>
      <td>input</td>
      <td>interval</td>
      <td>True</td>
      <td>int64</td>
    </tr>
    <tr>
      <th>ps_calc_07</th>
      <td>input</td>
      <td>interval</td>
      <td>True</td>
      <td>int64</td>
    </tr>
    <tr>
      <th>ps_calc_08</th>
      <td>input</td>
      <td>interval</td>
      <td>True</td>
      <td>int64</td>
    </tr>
    <tr>
      <th>ps_calc_09</th>
      <td>input</td>
      <td>interval</td>
      <td>True</td>
      <td>int64</td>
    </tr>
    <tr>
      <th>ps_calc_10</th>
      <td>input</td>
      <td>interval</td>
      <td>True</td>
      <td>int64</td>
    </tr>
    <tr>
      <th>ps_calc_11</th>
      <td>input</td>
      <td>interval</td>
      <td>True</td>
      <td>int64</td>
    </tr>
    <tr>
      <th>ps_calc_12</th>
      <td>input</td>
      <td>interval</td>
      <td>True</td>
      <td>int64</td>
    </tr>
    <tr>
      <th>ps_calc_13</th>
      <td>input</td>
      <td>interval</td>
      <td>True</td>
      <td>int64</td>
    </tr>
    <tr>
      <th>ps_calc_14</th>
      <td>input</td>
      <td>interval</td>
      <td>True</td>
      <td>int64</td>
    </tr>
    <tr>
      <th>ps_calc_15_bin</th>
      <td>input</td>
      <td>binary</td>
      <td>True</td>
      <td>int64</td>
    </tr>
    <tr>
      <th>ps_calc_16_bin</th>
      <td>input</td>
      <td>binary</td>
      <td>True</td>
      <td>int64</td>
    </tr>
    <tr>
      <th>ps_calc_17_bin</th>
      <td>input</td>
      <td>binary</td>
      <td>True</td>
      <td>int64</td>
    </tr>
    <tr>
      <th>ps_calc_18_bin</th>
      <td>input</td>
      <td>binary</td>
      <td>True</td>
      <td>int64</td>
    </tr>
    <tr>
      <th>ps_calc_19_bin</th>
      <td>input</td>
      <td>binary</td>
      <td>True</td>
      <td>int64</td>
    </tr>
    <tr>
      <th>ps_calc_20_bin</th>
      <td>input</td>
      <td>binary</td>
      <td>True</td>
      <td>int64</td>
    </tr>
  </tbody>
</table>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">meta</span><span class="p">[(</span><span class="n">meta</span><span class="p">.</span><span class="n">level</span> <span class="o">==</span> <span class="s">'nominal'</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">meta</span><span class="p">.</span><span class="n">keep</span><span class="p">)].</span><span class="n">index</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Index(['ps_ind_02_cat', 'ps_ind_03', 'ps_ind_04_cat', 'ps_ind_05_cat',
       'ps_car_01_cat', 'ps_car_02_cat', 'ps_car_03_cat', 'ps_car_04_cat',
       'ps_car_05_cat', 'ps_car_06_cat', 'ps_car_07_cat', 'ps_car_08_cat',
       'ps_car_09_cat', 'ps_car_10_cat', 'ps_car_11_cat', 'ps_car_11'],
      dtype='object', name='varname')
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s">'count'</span> <span class="p">:</span> <span class="n">meta</span><span class="p">.</span><span class="n">groupby</span><span class="p">([</span><span class="s">'role'</span><span class="p">,</span> <span class="s">'level'</span><span class="p">])[</span><span class="s">'role'</span><span class="p">].</span><span class="n">size</span><span class="p">()}).</span><span class="n">reset_index</span><span class="p">()</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>role</th>
      <th>level</th>
      <th>count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>id</td>
      <td>nominal</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>input</td>
      <td>binary</td>
      <td>20</td>
    </tr>
    <tr>
      <th>2</th>
      <td>input</td>
      <td>interval</td>
      <td>21</td>
    </tr>
    <tr>
      <th>3</th>
      <td>input</td>
      <td>nominal</td>
      <td>16</td>
    </tr>
    <tr>
      <th>4</th>
      <td>target</td>
      <td>binary</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>

<h2 id="통계량-살펴보기">통계량 살펴보기</h2>

<p>메타 데이터에서 interval인 값만 찾아서 describe를 사용할 수 있습니다.<br />
ps_reg_03, ps_car_12, ps_car_15에 결측값이 있습니다.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">v</span> <span class="o">=</span> <span class="n">meta</span><span class="p">[(</span><span class="n">meta</span><span class="p">.</span><span class="n">level</span> <span class="o">==</span> <span class="s">'interval'</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">meta</span><span class="p">.</span><span class="n">keep</span><span class="p">)].</span><span class="n">index</span>
<span class="n">train</span><span class="p">[</span><span class="n">v</span><span class="p">].</span><span class="n">describe</span><span class="p">()</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ps_reg_01</th>
      <th>ps_reg_02</th>
      <th>ps_reg_03</th>
      <th>ps_car_12</th>
      <th>ps_car_13</th>
      <th>ps_car_14</th>
      <th>ps_car_15</th>
      <th>ps_calc_01</th>
      <th>ps_calc_02</th>
      <th>ps_calc_03</th>
      <th>ps_calc_04</th>
      <th>ps_calc_05</th>
      <th>ps_calc_06</th>
      <th>ps_calc_07</th>
      <th>ps_calc_08</th>
      <th>ps_calc_09</th>
      <th>ps_calc_10</th>
      <th>ps_calc_11</th>
      <th>ps_calc_12</th>
      <th>ps_calc_13</th>
      <th>ps_calc_14</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>595212.000000</td>
      <td>595212.000000</td>
      <td>595212.000000</td>
      <td>595212.000000</td>
      <td>595212.000000</td>
      <td>595212.000000</td>
      <td>595212.000000</td>
      <td>595212.000000</td>
      <td>595212.000000</td>
      <td>595212.000000</td>
      <td>595212.000000</td>
      <td>595212.000000</td>
      <td>595212.000000</td>
      <td>595212.000000</td>
      <td>595212.000000</td>
      <td>595212.000000</td>
      <td>595212.000000</td>
      <td>595212.000000</td>
      <td>595212.000000</td>
      <td>595212.000000</td>
      <td>595212.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>0.610991</td>
      <td>0.439184</td>
      <td>0.551102</td>
      <td>0.379945</td>
      <td>0.813265</td>
      <td>0.276256</td>
      <td>3.065899</td>
      <td>0.449756</td>
      <td>0.449589</td>
      <td>0.449849</td>
      <td>2.372081</td>
      <td>1.885886</td>
      <td>7.689445</td>
      <td>3.005823</td>
      <td>9.225904</td>
      <td>2.339034</td>
      <td>8.433590</td>
      <td>5.441382</td>
      <td>1.441918</td>
      <td>2.872288</td>
      <td>7.539026</td>
    </tr>
    <tr>
      <th>std</th>
      <td>0.287643</td>
      <td>0.404264</td>
      <td>0.793506</td>
      <td>0.058327</td>
      <td>0.224588</td>
      <td>0.357154</td>
      <td>0.731366</td>
      <td>0.287198</td>
      <td>0.286893</td>
      <td>0.287153</td>
      <td>1.117219</td>
      <td>1.134927</td>
      <td>1.334312</td>
      <td>1.414564</td>
      <td>1.459672</td>
      <td>1.246949</td>
      <td>2.904597</td>
      <td>2.332871</td>
      <td>1.202963</td>
      <td>1.694887</td>
      <td>2.746652</td>
    </tr>
    <tr>
      <th>min</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>-1.000000</td>
      <td>-1.000000</td>
      <td>0.250619</td>
      <td>-1.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>2.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>0.400000</td>
      <td>0.200000</td>
      <td>0.525000</td>
      <td>0.316228</td>
      <td>0.670867</td>
      <td>0.333167</td>
      <td>2.828427</td>
      <td>0.200000</td>
      <td>0.200000</td>
      <td>0.200000</td>
      <td>2.000000</td>
      <td>1.000000</td>
      <td>7.000000</td>
      <td>2.000000</td>
      <td>8.000000</td>
      <td>1.000000</td>
      <td>6.000000</td>
      <td>4.000000</td>
      <td>1.000000</td>
      <td>2.000000</td>
      <td>6.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>0.700000</td>
      <td>0.300000</td>
      <td>0.720677</td>
      <td>0.374166</td>
      <td>0.765811</td>
      <td>0.368782</td>
      <td>3.316625</td>
      <td>0.500000</td>
      <td>0.400000</td>
      <td>0.500000</td>
      <td>2.000000</td>
      <td>2.000000</td>
      <td>8.000000</td>
      <td>3.000000</td>
      <td>9.000000</td>
      <td>2.000000</td>
      <td>8.000000</td>
      <td>5.000000</td>
      <td>1.000000</td>
      <td>3.000000</td>
      <td>7.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>0.900000</td>
      <td>0.600000</td>
      <td>1.000000</td>
      <td>0.400000</td>
      <td>0.906190</td>
      <td>0.396485</td>
      <td>3.605551</td>
      <td>0.700000</td>
      <td>0.700000</td>
      <td>0.700000</td>
      <td>3.000000</td>
      <td>3.000000</td>
      <td>9.000000</td>
      <td>4.000000</td>
      <td>10.000000</td>
      <td>3.000000</td>
      <td>10.000000</td>
      <td>7.000000</td>
      <td>2.000000</td>
      <td>4.000000</td>
      <td>9.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>0.900000</td>
      <td>1.800000</td>
      <td>4.037945</td>
      <td>1.264911</td>
      <td>3.720626</td>
      <td>0.636396</td>
      <td>3.741657</td>
      <td>0.900000</td>
      <td>0.900000</td>
      <td>0.900000</td>
      <td>5.000000</td>
      <td>6.000000</td>
      <td>10.000000</td>
      <td>9.000000</td>
      <td>12.000000</td>
      <td>7.000000</td>
      <td>25.000000</td>
      <td>19.000000</td>
      <td>10.000000</td>
      <td>13.000000</td>
      <td>23.000000</td>
    </tr>
  </tbody>
</table>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">v</span> <span class="o">=</span> <span class="n">meta</span><span class="p">[(</span><span class="n">meta</span><span class="p">.</span><span class="n">level</span> <span class="o">==</span> <span class="s">'binary'</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">meta</span><span class="p">.</span><span class="n">keep</span><span class="p">)].</span><span class="n">index</span>
<span class="n">train</span><span class="p">[</span><span class="n">v</span><span class="p">].</span><span class="n">describe</span><span class="p">()</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>target</th>
      <th>ps_ind_01</th>
      <th>ps_ind_06_bin</th>
      <th>ps_ind_07_bin</th>
      <th>ps_ind_08_bin</th>
      <th>ps_ind_09_bin</th>
      <th>ps_ind_10_bin</th>
      <th>ps_ind_11_bin</th>
      <th>ps_ind_12_bin</th>
      <th>ps_ind_13_bin</th>
      <th>ps_ind_14</th>
      <th>ps_ind_15</th>
      <th>ps_ind_16_bin</th>
      <th>ps_ind_17_bin</th>
      <th>ps_ind_18_bin</th>
      <th>ps_calc_15_bin</th>
      <th>ps_calc_16_bin</th>
      <th>ps_calc_17_bin</th>
      <th>ps_calc_18_bin</th>
      <th>ps_calc_19_bin</th>
      <th>ps_calc_20_bin</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>595212.000000</td>
      <td>595212.000000</td>
      <td>595212.000000</td>
      <td>595212.000000</td>
      <td>595212.000000</td>
      <td>595212.000000</td>
      <td>595212.000000</td>
      <td>595212.000000</td>
      <td>595212.000000</td>
      <td>595212.000000</td>
      <td>595212.000000</td>
      <td>595212.000000</td>
      <td>595212.000000</td>
      <td>595212.000000</td>
      <td>595212.000000</td>
      <td>595212.000000</td>
      <td>595212.000000</td>
      <td>595212.000000</td>
      <td>595212.000000</td>
      <td>595212.000000</td>
      <td>595212.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>0.036448</td>
      <td>1.900378</td>
      <td>0.393742</td>
      <td>0.257033</td>
      <td>0.163921</td>
      <td>0.185304</td>
      <td>0.000373</td>
      <td>0.001692</td>
      <td>0.009439</td>
      <td>0.000948</td>
      <td>0.012451</td>
      <td>7.299922</td>
      <td>0.660823</td>
      <td>0.121081</td>
      <td>0.153446</td>
      <td>0.122427</td>
      <td>0.627840</td>
      <td>0.554182</td>
      <td>0.287182</td>
      <td>0.349024</td>
      <td>0.153318</td>
    </tr>
    <tr>
      <th>std</th>
      <td>0.187401</td>
      <td>1.983789</td>
      <td>0.488579</td>
      <td>0.436998</td>
      <td>0.370205</td>
      <td>0.388544</td>
      <td>0.019309</td>
      <td>0.041097</td>
      <td>0.096693</td>
      <td>0.030768</td>
      <td>0.127545</td>
      <td>3.546042</td>
      <td>0.473430</td>
      <td>0.326222</td>
      <td>0.360417</td>
      <td>0.327779</td>
      <td>0.483381</td>
      <td>0.497056</td>
      <td>0.452447</td>
      <td>0.476662</td>
      <td>0.360295</td>
    </tr>
    <tr>
      <th>min</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>5.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>7.000000</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>0.000000</td>
      <td>3.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>10.000000</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>1.000000</td>
      <td>7.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>4.000000</td>
      <td>13.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
</div>

<p>target=1인 비율이 target=0보다 훨씬 작기 때문에 target=1을 오버 샘플링 혹은 target=0으로 언더샘플링 할 수 있습니다.<br />
언더 샘플링은 불균형한 데이터 셋에서 높은 비율을 차지하던 클래스의 데이터 수를 줄임으로써 데이터 불균형을 해소하는 아이디어 입니다.<br />
하지만 이 방법은 학습에 사용되는 전체 데이터 수를 급격하게 감소시켜 오히려 성능이 떨어질 수 있습니다.<br />
오버 샘플링은 낮은 비율 클래스의 데이터 수를 늘림으로써 데이터 불균형을 해소하는 아이디어 입니다.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">desired_apriori</span><span class="o">=</span><span class="mf">0.10</span>

<span class="n">idx_0</span> <span class="o">=</span> <span class="n">train</span><span class="p">[</span><span class="n">train</span><span class="p">.</span><span class="n">target</span> <span class="o">==</span> <span class="mi">0</span><span class="p">].</span><span class="n">index</span>
<span class="n">idx_1</span> <span class="o">=</span> <span class="n">train</span><span class="p">[</span><span class="n">train</span><span class="p">.</span><span class="n">target</span> <span class="o">==</span> <span class="mi">1</span><span class="p">].</span><span class="n">index</span>

<span class="n">nb_0</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">train</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx_0</span><span class="p">])</span>
<span class="n">nb_1</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">train</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx_1</span><span class="p">])</span>

<span class="n">undersampling_rate</span> <span class="o">=</span> <span class="p">((</span><span class="mi">1</span><span class="o">-</span><span class="n">desired_apriori</span><span class="p">)</span><span class="o">*</span><span class="n">nb_1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">nb_0</span><span class="o">*</span><span class="n">desired_apriori</span><span class="p">)</span>
<span class="n">undersampled_nb_0</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">undersampling_rate</span><span class="o">*</span><span class="n">nb_0</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">'Rate to undersample records with target=0: {}'</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">undersampling_rate</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="s">'Number of records with target=0 after undersampling: {}'</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">undersampled_nb_0</span><span class="p">))</span>

<span class="n">undersampled_idx</span> <span class="o">=</span> <span class="n">shuffle</span><span class="p">(</span><span class="n">idx_0</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">37</span><span class="p">,</span> <span class="n">n_samples</span><span class="o">=</span><span class="n">undersampled_nb_0</span><span class="p">)</span>

<span class="n">idx_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">undersampled_idx</span><span class="p">)</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">idx_1</span><span class="p">)</span>

<span class="n">train</span> <span class="o">=</span> <span class="n">train</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx_list</span><span class="p">].</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Rate to undersample records with target=0: 0.34043569687437886
Number of records with target=0 after undersampling: 195246
</code></pre></div></div>

<p>ps_car_03_cat 및 ps_car_05_cat는 결측값이 있는 비율이 높습니다. 이 변수를 제거합니다.<br />
결측값이 있는 다른 범주형 변수의 경우 결측값 -1을 그대로 둘 수 있습니다.<br />
ps_reg_03 (continuous)에는 18%에 대한 결측값이 있습니다. 평균으로 대체합니다.<br />
ps_car_11 (순서형)에는 결측 값이 5개만 있습니다. 모드로 대체합니다.<br />
ps_car_12 (연속)에는 결측값이 1개만 있습니다. 평균으로 대체합니다.<br />
ps_car_14 (연속)에는 7%에 대한 결측값이 있습니다. 평균으로 대체합니다.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">vars_to_drop</span> <span class="o">=</span> <span class="p">[</span><span class="s">'ps_car_03_cat'</span><span class="p">,</span> <span class="s">'ps_car_05_cat'</span><span class="p">]</span>
<span class="n">train</span><span class="p">.</span><span class="n">drop</span><span class="p">(</span><span class="n">vars_to_drop</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">meta</span><span class="p">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">vars_to_drop</span><span class="p">),</span><span class="s">'keep'</span><span class="p">]</span> <span class="o">=</span> <span class="bp">False</span>  <span class="c1"># 메타 데이터 update
</span>
<span class="n">mean_imp</span> <span class="o">=</span> <span class="n">SimpleImputer</span><span class="p">(</span><span class="n">missing_values</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">strategy</span><span class="o">=</span><span class="s">'mean'</span><span class="p">)</span>
<span class="n">mode_imp</span> <span class="o">=</span> <span class="n">SimpleImputer</span><span class="p">(</span><span class="n">missing_values</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">strategy</span><span class="o">=</span><span class="s">'most_frequent'</span><span class="p">)</span>
<span class="n">train</span><span class="p">[</span><span class="s">'ps_reg_03'</span><span class="p">]</span> <span class="o">=</span> <span class="n">mean_imp</span><span class="p">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">train</span><span class="p">[[</span><span class="s">'ps_reg_03'</span><span class="p">]]).</span><span class="n">ravel</span><span class="p">()</span>
<span class="n">train</span><span class="p">[</span><span class="s">'ps_car_12'</span><span class="p">]</span> <span class="o">=</span> <span class="n">mean_imp</span><span class="p">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">train</span><span class="p">[[</span><span class="s">'ps_car_12'</span><span class="p">]]).</span><span class="n">ravel</span><span class="p">()</span>
<span class="n">train</span><span class="p">[</span><span class="s">'ps_car_14'</span><span class="p">]</span> <span class="o">=</span> <span class="n">mean_imp</span><span class="p">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">train</span><span class="p">[[</span><span class="s">'ps_car_14'</span><span class="p">]]).</span><span class="n">ravel</span><span class="p">()</span>
<span class="n">train</span><span class="p">[</span><span class="s">'ps_car_11'</span><span class="p">]</span> <span class="o">=</span> <span class="n">mode_imp</span><span class="p">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">train</span><span class="p">[[</span><span class="s">'ps_car_11'</span><span class="p">]]).</span><span class="n">ravel</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">v</span> <span class="o">=</span> <span class="n">meta</span><span class="p">[(</span><span class="n">meta</span><span class="p">.</span><span class="n">level</span> <span class="o">==</span> <span class="s">'nominal'</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">meta</span><span class="p">.</span><span class="n">keep</span><span class="p">)].</span><span class="n">index</span>

<span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">v</span><span class="p">:</span>
    <span class="n">dist_values</span> <span class="o">=</span> <span class="n">train</span><span class="p">[</span><span class="n">f</span><span class="p">].</span><span class="n">value_counts</span><span class="p">().</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">print</span><span class="p">(</span><span class="s">'Variable {} has {} distinct values'</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">dist_values</span><span class="p">))</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Variable ps_ind_02_cat has 5 distinct values
Variable ps_ind_03 has 12 distinct values
Variable ps_ind_04_cat has 3 distinct values
Variable ps_ind_05_cat has 8 distinct values
Variable ps_car_01_cat has 13 distinct values
Variable ps_car_02_cat has 3 distinct values
Variable ps_car_04_cat has 10 distinct values
Variable ps_car_06_cat has 18 distinct values
Variable ps_car_07_cat has 3 distinct values
Variable ps_car_08_cat has 2 distinct values
Variable ps_car_09_cat has 6 distinct values
Variable ps_car_10_cat has 3 distinct values
Variable ps_car_11_cat has 104 distinct values
Variable ps_car_11 has 4 distinct values
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">add_noise</span><span class="p">(</span><span class="n">series</span><span class="p">,</span> <span class="n">noise_level</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">series</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">noise_level</span> <span class="o">*</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">randn</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">series</span><span class="p">)))</span>

<span class="k">def</span> <span class="nf">target_encode</span><span class="p">(</span><span class="n">trn_series</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> 
                  <span class="n">tst_series</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> 
                  <span class="n">target</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> 
                  <span class="n">min_samples_leaf</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> 
                  <span class="n">smoothing</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                  <span class="n">noise_level</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">trn_series</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">target</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">trn_series</span><span class="p">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">tst_series</span><span class="p">.</span><span class="n">name</span>
    <span class="n">temp</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">concat</span><span class="p">([</span><span class="n">trn_series</span><span class="p">,</span> <span class="n">target</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="c1"># 평균 계산
</span>    <span class="n">averages</span> <span class="o">=</span> <span class="n">temp</span><span class="p">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="n">trn_series</span><span class="p">.</span><span class="n">name</span><span class="p">)[</span><span class="n">target</span><span class="p">.</span><span class="n">name</span><span class="p">].</span><span class="n">agg</span><span class="p">([</span><span class="s">"mean"</span><span class="p">,</span> <span class="s">"count"</span><span class="p">])</span>

    <span class="n">smoothing</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">np</span><span class="p">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">averages</span><span class="p">[</span><span class="s">"count"</span><span class="p">]</span> <span class="o">-</span> <span class="n">min_samples_leaf</span><span class="p">)</span> <span class="o">/</span> <span class="n">smoothing</span><span class="p">))</span>
    
    <span class="n">prior</span> <span class="o">=</span> <span class="n">target</span><span class="p">.</span><span class="n">mean</span><span class="p">()</span>

    <span class="n">averages</span><span class="p">[</span><span class="n">target</span><span class="p">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">prior</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">smoothing</span><span class="p">)</span> <span class="o">+</span> <span class="n">averages</span><span class="p">[</span><span class="s">"mean"</span><span class="p">]</span> <span class="o">*</span> <span class="n">smoothing</span>
    <span class="n">averages</span><span class="p">.</span><span class="n">drop</span><span class="p">([</span><span class="s">"mean"</span><span class="p">,</span> <span class="s">"count"</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

    <span class="n">ft_trn_series</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">merge</span><span class="p">(</span>
        <span class="n">trn_series</span><span class="p">.</span><span class="n">to_frame</span><span class="p">(</span><span class="n">trn_series</span><span class="p">.</span><span class="n">name</span><span class="p">),</span>
        <span class="n">averages</span><span class="p">.</span><span class="n">reset_index</span><span class="p">().</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s">'index'</span><span class="p">:</span> <span class="n">target</span><span class="p">.</span><span class="n">name</span><span class="p">,</span> <span class="n">target</span><span class="p">.</span><span class="n">name</span><span class="p">:</span> <span class="s">'average'</span><span class="p">}),</span>
        <span class="n">on</span><span class="o">=</span><span class="n">trn_series</span><span class="p">.</span><span class="n">name</span><span class="p">,</span>
        <span class="n">how</span><span class="o">=</span><span class="s">'left'</span><span class="p">)[</span><span class="s">'average'</span><span class="p">].</span><span class="n">rename</span><span class="p">(</span><span class="n">trn_series</span><span class="p">.</span><span class="n">name</span> <span class="o">+</span> <span class="s">'_mean'</span><span class="p">).</span><span class="n">fillna</span><span class="p">(</span><span class="n">prior</span><span class="p">)</span>

    <span class="n">ft_trn_series</span><span class="p">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">trn_series</span><span class="p">.</span><span class="n">index</span> 
    <span class="n">ft_tst_series</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">merge</span><span class="p">(</span>
        <span class="n">tst_series</span><span class="p">.</span><span class="n">to_frame</span><span class="p">(</span><span class="n">tst_series</span><span class="p">.</span><span class="n">name</span><span class="p">),</span>
        <span class="n">averages</span><span class="p">.</span><span class="n">reset_index</span><span class="p">().</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s">'index'</span><span class="p">:</span> <span class="n">target</span><span class="p">.</span><span class="n">name</span><span class="p">,</span> <span class="n">target</span><span class="p">.</span><span class="n">name</span><span class="p">:</span> <span class="s">'average'</span><span class="p">}),</span>
        <span class="n">on</span><span class="o">=</span><span class="n">tst_series</span><span class="p">.</span><span class="n">name</span><span class="p">,</span>
        <span class="n">how</span><span class="o">=</span><span class="s">'left'</span><span class="p">)[</span><span class="s">'average'</span><span class="p">].</span><span class="n">rename</span><span class="p">(</span><span class="n">trn_series</span><span class="p">.</span><span class="n">name</span> <span class="o">+</span> <span class="s">'_mean'</span><span class="p">).</span><span class="n">fillna</span><span class="p">(</span><span class="n">prior</span><span class="p">)</span>

    <span class="n">ft_tst_series</span><span class="p">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">tst_series</span><span class="p">.</span><span class="n">index</span>
    <span class="k">return</span> <span class="n">add_noise</span><span class="p">(</span><span class="n">ft_trn_series</span><span class="p">,</span> <span class="n">noise_level</span><span class="p">),</span> <span class="n">add_noise</span><span class="p">(</span><span class="n">ft_tst_series</span><span class="p">,</span> <span class="n">noise_level</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">train_encoded</span><span class="p">,</span> <span class="n">test_encoded</span> <span class="o">=</span> <span class="n">target_encode</span><span class="p">(</span><span class="n">train</span><span class="p">[</span><span class="s">"ps_car_11_cat"</span><span class="p">],</span> 
                             <span class="n">test</span><span class="p">[</span><span class="s">"ps_car_11_cat"</span><span class="p">],</span> 
                             <span class="n">target</span><span class="o">=</span><span class="n">train</span><span class="p">.</span><span class="n">target</span><span class="p">,</span> 
                             <span class="n">min_samples_leaf</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
                             <span class="n">smoothing</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                             <span class="n">noise_level</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
    
<span class="n">train</span><span class="p">[</span><span class="s">'ps_car_11_cat_te'</span><span class="p">]</span> <span class="o">=</span> <span class="n">train_encoded</span>
<span class="n">train</span><span class="p">.</span><span class="n">drop</span><span class="p">(</span><span class="s">'ps_car_11_cat'</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">meta</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="s">'ps_car_11_cat'</span><span class="p">,</span><span class="s">'keep'</span><span class="p">]</span> <span class="o">=</span> <span class="bp">False</span>  <span class="c1"># 메타 데이터 업데이트
</span><span class="n">test</span><span class="p">[</span><span class="s">'ps_car_11_cat_te'</span><span class="p">]</span> <span class="o">=</span> <span class="n">test_encoded</span>
<span class="n">test</span><span class="p">.</span><span class="n">drop</span><span class="p">(</span><span class="s">'ps_car_11_cat'</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</code></pre></div></div>

<h2 id="탐색-데이터-시각화">탐색 데이터 시각화</h2>

<p>범주값으로 결측값을 유지한다면 비율을 확인하기 좋습니다.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">v</span> <span class="o">=</span> <span class="n">meta</span><span class="p">[(</span><span class="n">meta</span><span class="p">.</span><span class="n">level</span> <span class="o">==</span> <span class="s">'nominal'</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">meta</span><span class="p">.</span><span class="n">keep</span><span class="p">)].</span><span class="n">index</span>

<span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">v</span><span class="p">:</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">()</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
    <span class="n">cat_perc</span> <span class="o">=</span> <span class="n">train</span><span class="p">[[</span><span class="n">f</span><span class="p">,</span> <span class="s">'target'</span><span class="p">]].</span><span class="n">groupby</span><span class="p">([</span><span class="n">f</span><span class="p">],</span><span class="n">as_index</span><span class="o">=</span><span class="bp">False</span><span class="p">).</span><span class="n">mean</span><span class="p">()</span>
    <span class="n">cat_perc</span><span class="p">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s">'target'</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">sns</span><span class="p">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">f</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">'target'</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">cat_perc</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="n">cat_perc</span><span class="p">[</span><span class="n">f</span><span class="p">])</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">'% target'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s">'both'</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s">'major'</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">();</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;Figure size 432x288 with 0 Axes&gt;
</code></pre></div></div>

<p><img src="https://user-images.githubusercontent.com/54880474/142893878-25111238-4334-433f-8239-bb0f40b7efbc.png" alt="output_28_1" /></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;Figure size 432x288 with 0 Axes&gt;
</code></pre></div></div>

<p><img src="https://user-images.githubusercontent.com/54880474/142892960-16bc0890-6623-4fb0-bca7-e023eb591eee.png" alt="output_28_3" /></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;Figure size 432x288 with 0 Axes&gt;
</code></pre></div></div>

<p><img src="https://user-images.githubusercontent.com/54880474/142893982-17ed0431-f0b1-43dc-aecd-9eb21396abb1.png" alt="output_28_5" /></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;Figure size 432x288 with 0 Axes&gt;
</code></pre></div></div>

<p><img src="https://user-images.githubusercontent.com/54880474/142892968-195d2a0e-e4ed-4833-bf7f-9b7bacd477f1.png" alt="output_28_7" /></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;Figure size 432x288 with 0 Axes&gt;
</code></pre></div></div>

<p><img src="https://user-images.githubusercontent.com/54880474/142892970-d4bd0264-9c60-46d9-a7e9-d59532de3410.png" alt="output_28_9" /></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;Figure size 432x288 with 0 Axes&gt;
</code></pre></div></div>

<p><img src="https://user-images.githubusercontent.com/54880474/142892972-f2c9a9dd-1550-4628-9160-9e2f51c1c80a.png" alt="output_28_11" /></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;Figure size 432x288 with 0 Axes&gt;
</code></pre></div></div>

<p><img src="https://user-images.githubusercontent.com/54880474/142892974-5fd00df3-c8c0-4226-8dfa-272193d8684b.png" alt="output_28_13" /></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;Figure size 432x288 with 0 Axes&gt;
</code></pre></div></div>

<p><img src="https://user-images.githubusercontent.com/54880474/142892977-e234931d-9709-449b-aa56-02365d24705c.png" alt="output_28_15" /></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;Figure size 432x288 with 0 Axes&gt;
</code></pre></div></div>

<p><img src="https://user-images.githubusercontent.com/54880474/142892980-b71e34fa-7560-4075-8069-d05e205045f7.png" alt="output_28_17" /></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;Figure size 432x288 with 0 Axes&gt;
</code></pre></div></div>

<p><img src="https://user-images.githubusercontent.com/54880474/142892981-cb1cc7c7-528b-4707-a306-32c1e72d8ab5.png" alt="output_28_19" /></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;Figure size 432x288 with 0 Axes&gt;
</code></pre></div></div>

<p><img src="https://user-images.githubusercontent.com/54880474/142893002-2136acca-f27d-42fb-ab88-77b9929badfa.png" alt="output_28_21" /></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;Figure size 432x288 with 0 Axes&gt;
</code></pre></div></div>

<p><img src="https://user-images.githubusercontent.com/54880474/142892983-afe120c7-a202-4030-85f9-8694c299509b.png" alt="output_28_23" /></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;Figure size 432x288 with 0 Axes&gt;
</code></pre></div></div>

<p><img src="https://user-images.githubusercontent.com/54880474/142892985-8e396e0a-493f-46ae-b60d-74d4fbc03b84.png" alt="output_28_25" /></p>

<p>구간 변수는 상관 관계를 확인하는 것이 좋습니다.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">corr_heatmap</span><span class="p">(</span><span class="n">v</span><span class="p">):</span>
    <span class="n">correlations</span> <span class="o">=</span> <span class="n">train</span><span class="p">[</span><span class="n">v</span><span class="p">].</span><span class="n">corr</span><span class="p">()</span>

    <span class="n">cmap</span> <span class="o">=</span> <span class="n">sns</span><span class="p">.</span><span class="n">diverging_palette</span><span class="p">(</span><span class="mi">220</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">as_cmap</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
    <span class="n">sns</span><span class="p">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">correlations</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s">'.2f'</span><span class="p">,</span>
                <span class="n">square</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span> <span class="n">annot</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">cbar_kws</span><span class="o">=</span><span class="p">{</span><span class="s">"shrink"</span><span class="p">:</span> <span class="p">.</span><span class="mi">75</span><span class="p">})</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">();</span>
    
<span class="n">v</span> <span class="o">=</span> <span class="n">meta</span><span class="p">[(</span><span class="n">meta</span><span class="p">.</span><span class="n">level</span> <span class="o">==</span> <span class="s">'interval'</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">meta</span><span class="p">.</span><span class="n">keep</span><span class="p">)].</span><span class="n">index</span>
<span class="n">corr_heatmap</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
</code></pre></div></div>

<p><img src="https://user-images.githubusercontent.com/54880474/142892989-09747845-bb99-4ee9-a762-f6bd658ebff1.png" alt="output_30_0" /></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">s</span> <span class="o">=</span> <span class="n">train</span><span class="p">.</span><span class="n">sample</span><span class="p">(</span><span class="n">frac</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sns</span><span class="p">.</span><span class="n">lmplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s">'ps_reg_02'</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">'ps_reg_03'</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">s</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s">'target'</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s">'Set1'</span><span class="p">,</span> <span class="n">scatter_kws</span><span class="o">=</span><span class="p">{</span><span class="s">'alpha'</span><span class="p">:</span><span class="mf">0.3</span><span class="p">})</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

<p><img src="https://user-images.githubusercontent.com/54880474/142892992-ef2a2608-d164-4bfc-a83c-17aa542428ec.png" alt="output_32_0" /></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sns</span><span class="p">.</span><span class="n">lmplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s">'ps_car_12'</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">'ps_car_13'</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">s</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s">'target'</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s">'Set1'</span><span class="p">,</span> <span class="n">scatter_kws</span><span class="o">=</span><span class="p">{</span><span class="s">'alpha'</span><span class="p">:</span><span class="mf">0.3</span><span class="p">})</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

<p><img src="https://user-images.githubusercontent.com/54880474/142892993-1c901e8b-1919-4c27-8e0f-a6dac2ebe27b.png" alt="output_33_0" /></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sns</span><span class="p">.</span><span class="n">lmplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s">'ps_car_12'</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">'ps_car_14'</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">s</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s">'target'</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s">'Set1'</span><span class="p">,</span> <span class="n">scatter_kws</span><span class="o">=</span><span class="p">{</span><span class="s">'alpha'</span><span class="p">:</span><span class="mf">0.3</span><span class="p">})</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

<p><img src="https://user-images.githubusercontent.com/54880474/142892997-c17baa4b-a4e7-4034-a113-2f8c383f8592.png" alt="output_34_0" /></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sns</span><span class="p">.</span><span class="n">lmplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s">'ps_car_15'</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">'ps_car_13'</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">s</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s">'target'</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s">'Set1'</span><span class="p">,</span> <span class="n">scatter_kws</span><span class="o">=</span><span class="p">{</span><span class="s">'alpha'</span><span class="p">:</span><span class="mf">0.3</span><span class="p">})</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

<p><img src="https://user-images.githubusercontent.com/54880474/142893000-fddcff0e-6385-4af5-810d-124cdb4753e4.png" alt="output_35_0" /></p>

<h2 id="feature-engineering">Feature Engineering</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># 더미 변수 만들기
</span><span class="n">v</span> <span class="o">=</span> <span class="n">meta</span><span class="p">[(</span><span class="n">meta</span><span class="p">.</span><span class="n">level</span> <span class="o">==</span> <span class="s">'nominal'</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">meta</span><span class="p">.</span><span class="n">keep</span><span class="p">)].</span><span class="n">index</span>
<span class="k">print</span><span class="p">(</span><span class="s">'Before dummification we have {} variables in train'</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">train</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
<span class="n">train</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">train</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">v</span><span class="p">,</span> <span class="n">drop_first</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">'After dummification we have {} variables in train'</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">train</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Before dummification we have 57 variables in train
After dummification we have 121 variables in train
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># 상호작용 변수 만들기
</span><span class="n">v</span> <span class="o">=</span> <span class="n">meta</span><span class="p">[(</span><span class="n">meta</span><span class="p">.</span><span class="n">level</span> <span class="o">==</span> <span class="s">'interval'</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">meta</span><span class="p">.</span><span class="n">keep</span><span class="p">)].</span><span class="n">index</span>
<span class="n">poly</span> <span class="o">=</span> <span class="n">PolynomialFeatures</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">interaction_only</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">include_bias</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="n">interactions</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">poly</span><span class="p">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">train</span><span class="p">[</span><span class="n">v</span><span class="p">]),</span> <span class="n">columns</span><span class="o">=</span><span class="n">poly</span><span class="p">.</span><span class="n">get_feature_names</span><span class="p">(</span><span class="n">v</span><span class="p">))</span>
<span class="n">interactions</span><span class="p">.</span><span class="n">drop</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">'Before creating interactions we have {} variables in train'</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">train</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
<span class="n">train</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">concat</span><span class="p">([</span><span class="n">train</span><span class="p">,</span> <span class="n">interactions</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">'After creating interactions we have {} variables in train'</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">train</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>C:\Users\keonj\anaconda3\lib\site-packages\sklearn\utils\deprecation.py:87: FutureWarning: Function get_feature_names is deprecated; get_feature_names is deprecated in 1.0 and will be removed in 1.2. Please use get_feature_names_out instead.
  warnings.warn(msg, category=FutureWarning)


Before creating interactions we have 121 variables in train
After creating interactions we have 352 variables in train
</code></pre></div></div>

<h2 id="feature-selection">Feature Selection</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># VarianceThreshold을 통해 분산이 작은 값 제거
</span><span class="n">selector</span> <span class="o">=</span> <span class="n">VarianceThreshold</span><span class="p">(</span><span class="n">threshold</span><span class="o">=</span><span class="p">.</span><span class="mi">01</span><span class="p">)</span>
<span class="n">selector</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train</span><span class="p">.</span><span class="n">drop</span><span class="p">([</span><span class="s">'id'</span><span class="p">,</span> <span class="s">'target'</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">vectorize</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="ow">not</span> <span class="n">x</span><span class="p">)</span> 
<span class="n">v</span> <span class="o">=</span> <span class="n">train</span><span class="p">.</span><span class="n">drop</span><span class="p">([</span><span class="s">'id'</span><span class="p">,</span> <span class="s">'target'</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">).</span><span class="n">columns</span><span class="p">[</span><span class="n">f</span><span class="p">(</span><span class="n">selector</span><span class="p">.</span><span class="n">get_support</span><span class="p">())]</span>
<span class="k">print</span><span class="p">(</span><span class="s">'{} variables have too low variance.'</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">)))</span>
<span class="k">print</span><span class="p">(</span><span class="s">'These variables are {}'</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">v</span><span class="p">)))</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>28 variables have too low variance.
These variables are ['ps_ind_10_bin', 'ps_ind_11_bin', 'ps_ind_12_bin', 'ps_ind_13_bin', 'ps_car_12', 'ps_car_14', 'ps_car_11_cat_te', 'ps_ind_05_cat_2', 'ps_ind_05_cat_5', 'ps_car_01_cat_1', 'ps_car_01_cat_2', 'ps_car_04_cat_3', 'ps_car_04_cat_4', 'ps_car_04_cat_5', 'ps_car_04_cat_6', 'ps_car_04_cat_7', 'ps_car_06_cat_2', 'ps_car_06_cat_5', 'ps_car_06_cat_8', 'ps_car_06_cat_12', 'ps_car_06_cat_16', 'ps_car_06_cat_17', 'ps_car_09_cat_4', 'ps_car_10_cat_1', 'ps_car_10_cat_2', 'ps_car_12^2', 'ps_car_12 ps_car_14', 'ps_car_14^2']
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># 랜덤 포레스트를 통한 특성 선택 및 모델 선택
</span>
<span class="n">X_train</span> <span class="o">=</span> <span class="n">train</span><span class="p">.</span><span class="n">drop</span><span class="p">([</span><span class="s">'id'</span><span class="p">,</span> <span class="s">'target'</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">y_train</span> <span class="o">=</span> <span class="n">train</span><span class="p">[</span><span class="s">'target'</span><span class="p">]</span>

<span class="n">feat_labels</span> <span class="o">=</span> <span class="n">X_train</span><span class="p">.</span><span class="n">columns</span>

<span class="n">rf</span> <span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>

<span class="n">rf</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">importances</span> <span class="o">=</span> <span class="n">rf</span><span class="p">.</span><span class="n">feature_importances_</span>

<span class="n">indices</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">rf</span><span class="p">.</span><span class="n">feature_importances_</span><span class="p">)[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

<span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">X_train</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"%2d) %-*s %f"</span> <span class="o">%</span> <span class="p">(</span><span class="n">f</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span><span class="n">feat_labels</span><span class="p">[</span><span class="n">indices</span><span class="p">[</span><span class="n">f</span><span class="p">]],</span> <span class="n">importances</span><span class="p">[</span><span class="n">indices</span><span class="p">[</span><span class="n">f</span><span class="p">]]))</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> 1) ps_car_11_cat_te               0.008718
 2) ps_car_13 ps_calc_08           0.006701
 3) ps_car_13 ps_calc_06           0.006655
 4) ps_car_13^2                    0.006577
 5) ps_car_13                      0.006575
 6) ps_car_13 ps_car_14            0.006478
 7) ps_car_12 ps_car_13            0.006459
 8) ps_car_13 ps_car_15            0.006277
 9) ps_reg_01 ps_car_13            0.006266
10) ps_reg_03 ps_car_13            0.006250
11) ps_car_14 ps_calc_08           0.006093
12) ps_car_14 ps_calc_06           0.006032
13) ps_car_14 ps_car_15            0.005884
14) ps_reg_03 ps_car_14            0.005808
15) ps_car_13 ps_calc_10           0.005789
16) ps_car_13 ps_calc_14           0.005764
17) ps_reg_03 ps_calc_08           0.005740
18) ps_car_13 ps_calc_11           0.005700
19) ps_reg_03 ps_car_12            0.005685
20) ps_reg_03 ps_calc_06           0.005609
21) ps_car_14 ps_calc_10           0.005494
22) ps_car_13 ps_calc_07           0.005493
23) ps_reg_03 ps_calc_10           0.005473
24) ps_car_14 ps_calc_14           0.005460
25) ps_reg_01 ps_car_14            0.005427
26) ps_car_14 ps_calc_11           0.005415
27) ps_car_13 ps_calc_04           0.005409
28) ps_reg_03 ps_car_15            0.005362
29) ps_reg_03 ps_calc_11           0.005356
30) ps_reg_03 ps_calc_14           0.005352
31) ps_reg_02 ps_car_13            0.005295
32) ps_car_13 ps_calc_09           0.005189
33) ps_car_14                      0.005183
34) ps_car_14^2                    0.005173
35) ps_reg_01 ps_reg_03            0.005137
36) ps_car_12 ps_car_14            0.005126
37) ps_reg_03 ps_calc_07           0.005110
38) ps_car_14 ps_calc_07           0.005089
39) ps_reg_03                      0.005059
40) ps_car_13 ps_calc_01           0.005045
41) ps_reg_03^2                    0.005036
42) ps_car_14 ps_calc_04           0.005024
43) ps_car_13 ps_calc_13           0.005012
44) ps_reg_03 ps_calc_04           0.005008
45) ps_car_13 ps_calc_03           0.004984
46) ps_car_13 ps_calc_02           0.004975
47) ps_car_13 ps_calc_05           0.004943
48) ps_reg_03 ps_calc_09           0.004808
49) ps_car_14 ps_calc_09           0.004771
50) ps_reg_03 ps_calc_13           0.004765
51) ps_car_14 ps_calc_02           0.004708
52) ps_car_14 ps_calc_13           0.004702
53) ps_calc_10 ps_calc_14          0.004656
54) ps_car_15 ps_calc_10           0.004655
55) ps_car_14 ps_calc_01           0.004647
56) ps_calc_10 ps_calc_11          0.004636
57) ps_car_14 ps_calc_03           0.004620
58) ps_reg_03 ps_calc_02           0.004619
59) ps_car_15 ps_calc_08           0.004616
60) ps_reg_03 ps_calc_03           0.004603
61) ps_calc_08 ps_calc_10          0.004573
62) ps_car_14 ps_calc_05           0.004566
63) ps_reg_03 ps_calc_05           0.004565
64) ps_car_15 ps_calc_14           0.004556
65) ps_reg_02 ps_car_14            0.004543
66) ps_reg_03 ps_calc_01           0.004534
67) ps_car_12 ps_calc_08           0.004515
68) ps_calc_08 ps_calc_14          0.004505
69) ps_car_12 ps_calc_10           0.004476
70) ps_car_12 ps_car_15            0.004467
71) ps_calc_11 ps_calc_14          0.004441
72) ps_car_15 ps_calc_11           0.004412
73) ps_calc_06 ps_calc_10          0.004408
74) ps_reg_02 ps_reg_03            0.004406
75) ps_car_12 ps_calc_14           0.004391
76) ps_car_12 ps_calc_06           0.004376
77) ps_ind_15                      0.004353
78) ps_car_15 ps_calc_06           0.004341
79) ps_calc_06 ps_calc_14          0.004306
80) ps_calc_08 ps_calc_11          0.004282
81) ps_calc_06 ps_calc_08          0.004253
82) ps_car_12 ps_calc_11           0.004188
83) ps_calc_07 ps_calc_10          0.004163
84) ps_calc_06 ps_calc_11          0.004134
85) ps_calc_07 ps_calc_14          0.004076
86) ps_calc_02 ps_calc_10          0.004032
87) ps_calc_01 ps_calc_14          0.004025
88) ps_car_13 ps_calc_12           0.004025
89) ps_calc_01 ps_calc_10          0.004011
90) ps_reg_01 ps_calc_10           0.004011
91) ps_calc_03 ps_calc_10          0.004008
92) ps_calc_10 ps_calc_13          0.003989
93) ps_calc_04 ps_calc_10          0.003985
94) ps_calc_03 ps_calc_14          0.003971
95) ps_calc_13 ps_calc_14          0.003970
96) ps_car_15 ps_calc_07           0.003945
97) ps_calc_02 ps_calc_14          0.003937
98) ps_reg_01 ps_calc_14           0.003925
99) ps_calc_09 ps_calc_10          0.003895
100) ps_calc_04 ps_calc_14          0.003877
101) ps_calc_07 ps_calc_08          0.003863
102) ps_reg_03 ps_calc_12           0.003849
103) ps_calc_01 ps_calc_11          0.003822
104) ps_calc_09 ps_calc_14          0.003819
105) ps_reg_02 ps_car_15            0.003806
106) ps_calc_07 ps_calc_11          0.003779
107) ps_reg_02 ps_calc_10           0.003771
108) ps_calc_03 ps_calc_11          0.003771
109) ps_calc_02 ps_calc_11          0.003757
110) ps_reg_02 ps_calc_14           0.003757
111) ps_reg_01 ps_car_15            0.003754
112) ps_car_14 ps_calc_12           0.003745
113) ps_calc_01 ps_calc_08          0.003725
114) ps_calc_05 ps_calc_10          0.003722
115) ps_car_15 ps_calc_13           0.003717
116) ps_car_12 ps_calc_01           0.003715
117) ps_calc_11 ps_calc_13          0.003708
118) ps_calc_03 ps_calc_08          0.003693
119) ps_car_15 ps_calc_02           0.003684
120) ps_car_12 ps_calc_07           0.003682
121) ps_calc_06 ps_calc_07          0.003680
122) ps_car_15 ps_calc_03           0.003676
123) ps_car_12 ps_calc_03           0.003671
124) ps_car_12 ps_calc_02           0.003670
125) ps_car_15 ps_calc_01           0.003668
126) ps_calc_08 ps_calc_13          0.003664
127) ps_car_15 ps_calc_09           0.003660
128) ps_reg_01 ps_car_12            0.003653
129) ps_car_15 ps_calc_04           0.003648
130) ps_calc_02 ps_calc_08          0.003647
131) ps_reg_01 ps_calc_11           0.003636
132) ps_calc_04 ps_calc_11          0.003621
133) ps_reg_02 ps_calc_11           0.003607
134) ps_calc_05 ps_calc_14          0.003590
135) ps_calc_09 ps_calc_11          0.003569
136) ps_reg_01 ps_calc_08           0.003557
137) ps_calc_04 ps_calc_08          0.003544
138) ps_reg_02 ps_car_12            0.003506
139) ps_car_12 ps_calc_13           0.003504
140) ps_reg_02 ps_calc_08           0.003498
141) ps_calc_08 ps_calc_09          0.003486
142) ps_calc_02 ps_calc_07          0.003485
143) ps_calc_06 ps_calc_13          0.003480
144) ps_calc_01 ps_calc_06          0.003478
145) ps_calc_03 ps_calc_07          0.003461
146) ps_calc_03 ps_calc_06          0.003435
147) ps_car_12 ps_calc_04           0.003432
148) ps_calc_02 ps_calc_06          0.003429
149) ps_calc_01 ps_calc_13          0.003413
150) ps_reg_02 ps_calc_06           0.003413
151) ps_calc_01 ps_calc_07          0.003402
152) ps_calc_01 ps_calc_02          0.003385
153) ps_calc_02 ps_calc_13          0.003379
154) ps_car_15 ps_calc_05           0.003358
155) ps_calc_03 ps_calc_13          0.003357
156) ps_calc_04 ps_calc_06          0.003357
157) ps_calc_02 ps_calc_03          0.003345
158) ps_calc_01 ps_calc_03          0.003338
159) ps_calc_05 ps_calc_11          0.003313
160) ps_calc_05 ps_calc_08          0.003306
161) ps_car_12 ps_calc_09           0.003306
162) ps_reg_01 ps_calc_06           0.003295
163) ps_calc_06 ps_calc_09          0.003271
164) ps_calc_03 ps_calc_09          0.003266
165) ps_calc_03 ps_calc_04          0.003259
166) ps_reg_02 ps_calc_01           0.003258
167) ps_calc_02 ps_calc_09          0.003207
168) ps_calc_01 ps_calc_09          0.003206
169) ps_reg_02 ps_calc_03           0.003195
170) ps_reg_02 ps_calc_02           0.003194
171) ps_calc_10 ps_calc_12          0.003190
172) ps_calc_02 ps_calc_04          0.003190
173) ps_calc_01 ps_calc_04          0.003184
174) ps_calc_07 ps_calc_13          0.003152
175) ps_reg_02 ps_calc_07           0.003144
176) ps_calc_12 ps_calc_14          0.003128
177) ps_reg_01 ps_calc_07           0.003110
178) ps_car_12 ps_calc_05           0.003106
179) ps_reg_01 ps_calc_13           0.003098
180) ps_calc_02 ps_calc_05          0.003069
181) ps_calc_05 ps_calc_06          0.003065
182) ps_calc_01 ps_calc_05          0.003065
183) ps_calc_03 ps_calc_05          0.003060
184) ps_reg_01 ps_calc_03           0.003045
185) ps_reg_02 ps_calc_13           0.003041
186) ps_calc_09 ps_calc_13          0.003035
187) ps_reg_01 ps_calc_01           0.003024
188) ps_reg_01 ps_calc_02           0.003007
189) ps_calc_04 ps_calc_13          0.002981
190) ps_calc_07 ps_calc_09          0.002955
191) ps_calc_11 ps_calc_12          0.002941
192) ps_calc_04 ps_calc_07          0.002920
193) ps_reg_02 ps_calc_04           0.002900
194) ps_reg_02 ps_calc_09           0.002900
195) ps_ind_01                      0.002898
196) ps_car_15 ps_calc_12           0.002890
197) ps_reg_01 ps_reg_02            0.002855
198) ps_reg_01 ps_calc_09           0.002844
199) ps_calc_05 ps_calc_13          0.002819
200) ps_reg_01 ps_calc_04           0.002815
201) ps_reg_02 ps_calc_05           0.002813
202) ps_calc_02 ps_calc_12          0.002800
203) ps_calc_08 ps_calc_12          0.002791
204) ps_calc_05 ps_calc_07          0.002779
205) ps_calc_01 ps_calc_12          0.002768
206) ps_calc_03 ps_calc_12          0.002737
207) ps_car_12 ps_calc_12           0.002715
208) ps_reg_01 ps_calc_05           0.002691
209) ps_calc_10                     0.002666
210) ps_calc_06 ps_calc_12          0.002662
211) ps_calc_10^2                   0.002659
212) ps_calc_04 ps_calc_09          0.002657
213) ps_calc_14^2                   0.002583
214) ps_ind_05_cat_0                0.002573
215) ps_calc_14                     0.002549
216) ps_calc_05 ps_calc_09          0.002523
217) ps_calc_12 ps_calc_13          0.002499
218) ps_calc_07 ps_calc_12          0.002487
219) ps_calc_04 ps_calc_05          0.002485
220) ps_reg_02 ps_calc_12           0.002445
221) ps_calc_09 ps_calc_12          0.002351
222) ps_reg_01 ps_calc_12           0.002345
223) ps_calc_11^2                   0.002291
224) ps_calc_11                     0.002261
225) ps_calc_04 ps_calc_12          0.002256
226) ps_car_15                      0.002243
227) ps_car_15^2                    0.002221
228) ps_car_12                      0.002203
229) ps_car_12^2                    0.002182
230) ps_calc_05 ps_calc_12          0.002146
231) ps_calc_08                     0.002133
232) ps_calc_08^2                   0.002118
233) ps_calc_03                     0.001906
234) ps_calc_01                     0.001902
235) ps_calc_01^2                   0.001899
236) ps_calc_03^2                   0.001897
237) ps_calc_02^2                   0.001890
238) ps_calc_02                     0.001872
239) ps_calc_06^2                   0.001859
240) ps_calc_06                     0.001849
241) ps_reg_02^2                    0.001763
242) ps_ind_17_bin                  0.001735
243) ps_reg_02                      0.001712
244) ps_calc_13^2                   0.001696
245) ps_calc_13                     0.001695
246) ps_calc_07^2                   0.001607
247) ps_calc_07                     0.001594
248) ps_reg_01                      0.001457
249) ps_reg_01^2                    0.001445
250) ps_calc_09^2                   0.001385
251) ps_calc_09                     0.001382
252) ps_calc_04^2                   0.001287
253) ps_calc_04                     0.001279
254) ps_calc_05                     0.001251
255) ps_calc_05^2                   0.001245
256) ps_car_07_cat_1                0.001210
257) ps_calc_12^2                   0.001203
258) ps_calc_12                     0.001184
259) ps_ind_16_bin                  0.001039
260) ps_ind_05_cat_6                0.000984
261) ps_ind_07_bin                  0.000935
262) ps_car_09_cat_1                0.000840
263) ps_ind_06_bin                  0.000810
264) ps_ind_02_cat_1                0.000746
265) ps_car_01_cat_9                0.000733
266) ps_calc_17_bin                 0.000731
267) ps_ind_04_cat_1                0.000725
268) ps_ind_04_cat_0                0.000720
269) ps_car_07_cat_0                0.000716
270) ps_calc_19_bin                 0.000713
271) ps_ind_02_cat_2                0.000712
272) ps_calc_18_bin                 0.000710
273) ps_car_01_cat_11               0.000710
274) ps_calc_16_bin                 0.000702
275) ps_ind_05_cat_4                0.000700
276) ps_ind_03_7                    0.000691
277) ps_ind_03_1                    0.000691
278) ps_car_09_cat_2                0.000678
279) ps_ind_05_cat_2                0.000672
280) ps_ind_08_bin                  0.000672
281) ps_car_01_cat_7                0.000672
282) ps_ind_03_6                    0.000671
283) ps_car_06_cat_1                0.000669
284) ps_car_11_3                    0.000646
285) ps_car_09_cat_0                0.000643
286) ps_ind_03_5                    0.000635
287) ps_car_11_2                    0.000629
288) ps_calc_15_bin                 0.000627
289) ps_ind_03_8                    0.000613
290) ps_calc_20_bin                 0.000608
291) ps_car_04_cat_2                0.000606
292) ps_car_01_cat_4                0.000604
293) ps_ind_18_bin                  0.000579
294) ps_car_06_cat_11               0.000572
295) ps_ind_03_10                   0.000571
296) ps_ind_03_3                    0.000563
297) ps_ind_03_2                    0.000561
298) ps_car_01_cat_8                0.000558
299) ps_ind_02_cat_4                0.000557
300) ps_car_01_cat_10               0.000555
301) ps_ind_09_bin                  0.000550
302) ps_ind_02_cat_3                0.000543
303) ps_car_06_cat_14               0.000535
304) ps_ind_03_9                    0.000534
305) ps_car_01_cat_6                0.000526
306) ps_ind_03_11                   0.000522
307) ps_ind_03_4                    0.000515
308) ps_car_01_cat_5                0.000511
309) ps_car_02_cat_0                0.000507
310) ps_car_02_cat_1                0.000504
311) ps_ind_14                      0.000502
312) ps_car_06_cat_6                0.000483
313) ps_car_06_cat_4                0.000478
314) ps_car_08_cat_1                0.000471
315) ps_car_01_cat_3                0.000445
316) ps_car_01_cat_0                0.000439
317) ps_car_06_cat_10               0.000438
318) ps_car_06_cat_7                0.000432
319) ps_ind_05_cat_1                0.000422
320) ps_car_09_cat_3                0.000404
321) ps_car_04_cat_1                0.000402
322) ps_ind_12_bin                  0.000380
323) ps_car_06_cat_9                0.000372
324) ps_car_06_cat_15               0.000365
325) ps_car_11_1                    0.000363
326) ps_car_10_cat_1                0.000362
327) ps_car_09_cat_4                0.000355
328) ps_ind_05_cat_3                0.000334
329) ps_car_01_cat_2                0.000324
330) ps_car_06_cat_3                0.000321
331) ps_car_06_cat_17               0.000276
332) ps_car_06_cat_12               0.000270
333) ps_car_06_cat_16               0.000235
334) ps_car_01_cat_1                0.000232
335) ps_car_04_cat_8                0.000218
336) ps_car_04_cat_9                0.000212
337) ps_ind_05_cat_5                0.000184
338) ps_car_06_cat_13               0.000180
339) ps_car_06_cat_5                0.000178
340) ps_ind_11_bin                  0.000143
341) ps_car_04_cat_6                0.000132
342) ps_ind_13_bin                  0.000095
343) ps_car_04_cat_3                0.000087
344) ps_car_06_cat_2                0.000066
345) ps_car_04_cat_5                0.000058
346) ps_car_04_cat_7                0.000056
347) ps_car_06_cat_8                0.000045
348) ps_car_10_cat_2                0.000045
349) ps_ind_10_bin                  0.000045
350) ps_car_04_cat_4                0.000027
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sfm</span> <span class="o">=</span> <span class="n">SelectFromModel</span><span class="p">(</span><span class="n">rf</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="s">'median'</span><span class="p">,</span> <span class="n">prefit</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">'Number of features before selection: {}'</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">X_train</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
<span class="n">n_features</span> <span class="o">=</span> <span class="n">sfm</span><span class="p">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">).</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="k">print</span><span class="p">(</span><span class="s">'Number of features after selection: {}'</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">n_features</span><span class="p">))</span>
<span class="n">selected_vars</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">feat_labels</span><span class="p">[</span><span class="n">sfm</span><span class="p">.</span><span class="n">get_support</span><span class="p">()])</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Number of features before selection: 350


C:\Users\keonj\anaconda3\lib\site-packages\sklearn\base.py:438: UserWarning: X has feature names, but SelectFromModel was fitted without feature names
  warnings.warn(


Number of features after selection: 175
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Feature scaling
</span><span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
<span class="n">scaler</span><span class="p">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">train</span><span class="p">.</span><span class="n">drop</span><span class="p">([</span><span class="s">'target'</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>array([[-0.90494248, -0.45941104,  1.25877984, ...,  0.40315483,
         0.14885213, -0.62460393],
       [ 0.24006954,  1.55538958,  1.25877984, ..., -0.17489762,
        -0.04208459, -0.33950182],
       [ 1.64508122,  1.05168943,  1.25877984, ..., -0.17489762,
         0.53072557,  0.77897569],
       ...,
       [ 1.73477713, -0.9631112 , -0.7944201 , ..., -0.83552899,
        -0.99676819, -0.62460393],
       [ 1.73485162, -0.9631112 ,  1.25877984, ...,  0.40315483,
        -0.36031245, -1.06322256],
       [ 1.73512631, -0.45941104, -0.7944201 , ...,  0.40315483,
         0.91259901,  0.36228799]])
</code></pre></div></div>


                </div>
            </section>

            <!-- Email subscribe form at the bottom of the page -->
            <!--
            
                <section class="subscribe-form">
                    <h3 class="subscribe-form-title">Subscribe to 주건나's Blog</h3>
                    <p>Get the latest posts delivered right to your inbox</p>
                    <span id="searchform" method="post" action="/subscribe/" class="">
    <input class="confirm" type="hidden" name="confirm"  />
    <input class="location" type="hidden" name="location"  />
    <input class="referrer" type="hidden" name="referrer"  />

    <div class="form-group">
        <input class="subscribe-email" onkeyup="myFunc()" 
               id="searchtext" type="text" name="searchtext"  
               placeholder="Search..." />
    </div>
    <script type="text/javascript">
        function myFunc() {
            if(event.keyCode == 13) {
                var url = encodeURIComponent($("#searchtext").val());
                location.href = "/search.html?query=" + url;
            }
        }
    </script>
</span>
                </section>
            
            -->
            <footer class="post-full-footer">
                <!-- Everything inside the #author tags pulls data from the author -->
                <!-- #author-->
                
                    
                        <section class="author-card">
                            
                                <img class="author-profile-image" src="/assets/built/images/economy-author-logo.jpg" alt="keonju" />
                            
                            <section class="author-card-content">
                                <h4 class="author-card-name"><a href="/author/keonju">주건나</a></h4>
                                
                                    <p>데이터 / ML / DL / AI 관련 공부중입니다.</p>
                                
                            </section>
                        </section>
                        <div class="post-full-footer-right">
                            <a class="author-card-button" href="/author/keonju">Read More</a>
                        </div>
                    
                
                <!-- /author  -->
            </footer>

            <!-- If you use Disqus comments, just uncomment this block.
            The only thing you need to change is "test-apkdzgmqhj" - which
            should be replaced with your own Disqus site-id. -->
            
                <section class="post-full-comments">
                    <div id="disqus_thread"></div>
                    <script>
                        var disqus_config = function () {
                            var this_page_url = 'https://keonju2.github.io/programming-kaggle5';
                            var this_page_identifier = '/programming-kaggle5';
                            var this_page_title = '캐글 (5) <br> 메타 데이터를 이용한 <br> 데이터 관찰 및 준비';
                        };
                        (function() {
                            var d = document, s = d.createElement('script');
                            s.src = 'https://xxxxxxxx.disqus.com/embed.js';
                            s.setAttribute('data-timestamp', +new Date());
                            (d.head || d.body).appendChild(s);
                        })();
                    </script>
                </section>
            

        </article>

    </div>
</main>

<!-- Links to Previous/Next posts -->
<aside class="read-next outer">
    <div class="inner">
        <div class="read-next-feed">
            
                
                
                
                
                    <article class="read-next-card"
                        
                            style="background-image: url(/assets/built/images/blog-cover1.jpg)"
                        
                    >
                        <header class="read-next-card-header">
                            <small class="read-next-card-header-sitetitle">&mdash; 주건나's Blog &mdash;</small>
                            
                                <h3 class="read-next-card-header-title"><a href="/tag/programming/">Programming</a></h3>
                            
                        </header>
                        <div class="read-next-divider"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 14.5s2 3 5 3 5.5-2.463 5.5-5.5S21 6.5 18 6.5c-5 0-7 11-12 11C2.962 17.5.5 15.037.5 12S3 6.5 6 6.5s4.5 3.5 4.5 3.5"/></svg>
</div>
                        <div class="read-next-card-content">
                            <ul>
                                
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                            <li><a href="/programming-baekjoon9">백준 (9) <br> (1927,11279,11286, <br> 1715,11766)</a></li>
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                            <li><a href="/programming-kaggle4">캐글 (4) 타이타닉 생존자 앙상블과 스태킹까지</a></li>
                                        
                                    
                                  
                                
                                  
                                
                                  
                                    
                                        
                                        
                                            <li><a href="/programming-baekjoon8">백준 (8) <br> (10845,1158,1966,2164, <br> 11866,18258)</a></li>
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                            </ul>
                        </div>
                        <footer class="read-next-card-footer">
                            <a href="/tag/programming/">
                                
                                    See all 14 posts  →
                                
                            </a>
                        </footer>
                    </article>
                
            

            <!-- If there's a next post, display it using the same markup included from - partials/post-card.hbs -->
            
                

    <article class="post-card post-template">
        
            <a class="post-card-image-link" href="/study-book1">
                <div class="post-card-image" style="background-image: url(/assets/built/images/ML.png)"></div>
            </a>
        
        <div class="post-card-content">
            <a class="post-card-content-link" href="/study-book1">
                <header class="post-card-header">
                    
                        
                            
                                <span class="post-card-tags">Study</span>
                            
                        
                    

                    <h2 class="post-card-title">책 서평 (1) <br> 텐초의 파이토치 딥러닝 특강</h2>
                </header>
                <section class="post-card-excerpt">
                    
                        <p>서평 관련 글

    텐초의 파이토치 딥러닝 특강


</p>
                    
                </section>
            </a>
            <footer class="post-card-meta">
                
                    
                        
                        <img class="author-profile-image" src="/assets/built/images/economy-author-logo.jpg" alt="주건나" />
                        
                        <span class="post-card-author">
                            <a href="/author/keonju/">주건나</a>
                        </span>
                    
                
                <span class="reading-time">
                    
                    
                      1 min read
                    
                </span>
            </footer>
        </div>
    </article>

            

            <!-- If there's a previous post, display it using the same markup included from - partials/post-card.hbs -->
            
                

    <article class="post-card post-template">
        
            <a class="post-card-image-link" href="/programming-baekjoon9">
                <div class="post-card-image" style="background-image: url(/assets/built/images/baekjoon-logo.png)"></div>
            </a>
        
        <div class="post-card-content">
            <a class="post-card-content-link" href="/programming-baekjoon9">
                <header class="post-card-header">
                    
                        
                            
                                <span class="post-card-tags">Programming</span>
                            
                        
                    

                    <h2 class="post-card-title">백준 (9) <br> (1927,11279,11286, <br> 1715,11766)</h2>
                </header>
                <section class="post-card-excerpt">
                    
                        <p>백준 관련 글 백준 (1) (2557, 8958, 1000, 1001, 1008, 2935, 2753, 2884, 5063, 4101) 백준 (2) (1018, 1085, 1181, 1259, 1436, 1654, 1874, 1920) 백준 (3) 문자열 알고리즘(11720, 8958, 1152, 10809, 1157,</p>
                    
                </section>
            </a>
            <footer class="post-card-meta">
                
                    
                        
                        <img class="author-profile-image" src="/assets/built/images/economy-author-logo.jpg" alt="주건나" />
                        
                        <span class="post-card-author">
                            <a href="/author/keonju/">주건나</a>
                        </span>
                    
                
                <span class="reading-time">
                    
                    
                      3 min read
                    
                </span>
            </footer>
        </div>
    </article>

            

        </div>
    </div>
</aside>

<!-- Floating header which appears on-scroll, included from includes/floating-header.hbs -->
<div class="floating-header">
    <div class="floating-header-logo">
        <a href="https://keonju2.github.io/">
            
            <span>주건나's Blog</span>
        </a>
    </div>
    <span class="floating-header-divider">&mdash;</span>
    <div class="floating-header-title">캐글 (5) <br> 메타 데이터를 이용한 <br> 데이터 관찰 및 준비</div>
    <div class="floating-header-share">
        <div class="floating-header-share-label">Share this <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
    <path d="M7.5 15.5V4a1.5 1.5 0 1 1 3 0v4.5h2a1 1 0 0 1 1 1h2a1 1 0 0 1 1 1H18a1.5 1.5 0 0 1 1.5 1.5v3.099c0 .929-.13 1.854-.385 2.748L17.5 23.5h-9c-1.5-2-5.417-8.673-5.417-8.673a1.2 1.2 0 0 1 1.76-1.605L7.5 15.5zm6-6v2m-3-3.5v3.5m6-1v2"/>
</svg>
</div>
        <a class="floating-header-share-tw" href="https://twitter.com/share?text=%EC%BA%90%EA%B8%80+%285%29+%3Cbr%3E+%EB%A9%94%ED%83%80+%EB%8D%B0%EC%9D%B4%ED%84%B0%EB%A5%BC+%EC%9D%B4%EC%9A%A9%ED%95%9C+%3Cbr%3E+%EB%8D%B0%EC%9D%B4%ED%84%B0+%EA%B4%80%EC%B0%B0+%EB%B0%8F+%EC%A4%80%EB%B9%84&amp;url=https://keonju2.github.io/programming-kaggle5"
            onclick="window.open(this.href, 'share-twitter', 'width=550,height=235');return false;">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M30.063 7.313c-.813 1.125-1.75 2.125-2.875 2.938v.75c0 1.563-.188 3.125-.688 4.625a15.088 15.088 0 0 1-2.063 4.438c-.875 1.438-2 2.688-3.25 3.813a15.015 15.015 0 0 1-4.625 2.563c-1.813.688-3.75 1-5.75 1-3.25 0-6.188-.875-8.875-2.625.438.063.875.125 1.375.125 2.688 0 5.063-.875 7.188-2.5-1.25 0-2.375-.375-3.375-1.125s-1.688-1.688-2.063-2.875c.438.063.813.125 1.125.125.5 0 1-.063 1.5-.25-1.313-.25-2.438-.938-3.313-1.938a5.673 5.673 0 0 1-1.313-3.688v-.063c.813.438 1.688.688 2.625.688a5.228 5.228 0 0 1-1.875-2c-.5-.875-.688-1.813-.688-2.75 0-1.063.25-2.063.75-2.938 1.438 1.75 3.188 3.188 5.25 4.25s4.313 1.688 6.688 1.813a5.579 5.579 0 0 1 1.5-5.438c1.125-1.125 2.5-1.688 4.125-1.688s3.063.625 4.188 1.813a11.48 11.48 0 0 0 3.688-1.375c-.438 1.375-1.313 2.438-2.563 3.188 1.125-.125 2.188-.438 3.313-.875z"/></svg>

        </a>
        <a class="floating-header-share-fb" href="https://www.facebook.com/sharer/sharer.php?u=https://keonju2.github.io/programming-kaggle5"
            onclick="window.open(this.href, 'share-facebook','width=580,height=296');return false;">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M19 6h5V0h-5c-3.86 0-7 3.14-7 7v3H8v6h4v16h6V16h5l1-6h-6V7c0-.542.458-1 1-1z"/></svg>

        </a>
    </div>
    <progress class="progress" value="0">
        <div class="progress-container">
            <span class="progress-bar"></span>
        </div>
    </progress>
</div>


<!-- /post -->

<!-- The #contentFor helper here will send everything inside it up to the matching #block helper found in default.hbs -->


        <!-- Previous/next page links - displayed on every page -->
        

        <!-- The footer at the very bottom of the screen -->
        <footer class="site-footer outer">
            <div class="site-footer-content inner">
                <section class="copyright"><a href="https://keonju2.github.io/">주건나's Blog</a> &copy; 2023</section>
                <!--
                <section class="poweredby">Proudly published with <a href="https://jekyllrb.com/">Jekyll</a> &
                    <a href="https://pages.github.com/" target="_blank" rel="noopener">GitHub Pages</a> using
                    <a href="https://github.com/jekyllt/jasper2" target="_blank" rel="noopener">Jasper2</a></section>
                -->
                <nav class="site-footer-nav">
                    <a href="/">Latest Posts</a>
                    <a href="https://facebook.com/monkeykeonju" target="_blank" rel="noopener">Facebook</a>
                    
                    <!--
                    <a href="https://ghost.org" target="_blank" rel="noopener">Ghost</a>
                     -->
                </nav>

            </div>
        </footer>

    </div>

    <!-- The big email subscribe modal content -->
    
    <div id="subscribe" class="subscribe-overlay">
        <a class="subscribe-overlay-close" href="#"></a>
        <div class="subscribe-overlay-content">
            
            <h1 class="subscribe-overlay-title">Search 주건나's Blog</h1>
            <p class="subscribe-overlay-description">
            검색어를 입력해주세요 </p>
            <span id="searchform" method="post" action="/subscribe/" class="">
    <input class="confirm" type="hidden" name="confirm"  />
    <input class="location" type="hidden" name="location"  />
    <input class="referrer" type="hidden" name="referrer"  />

    <div class="form-group">
        <input class="subscribe-email" onkeyup="myFunc()" 
               id="searchtext" type="text" name="searchtext"  
               placeholder="Search..." />
    </div>
    <script type="text/javascript">
        function myFunc() {
            if(event.keyCode == 13) {
                var url = encodeURIComponent($("#searchtext").val());
                location.href = "/search.html?query=" + url;
            }
        }
    </script>
</span>
        </div>
    </div>
    


    <!-- highlight.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.10.0/components/prism-abap.min.js"></script>
    <script>$(document).ready(function() {
      $('pre code').each(function(i, block) {
        hljs.highlightBlock(block);
      });
    });</script>

    <!-- jQuery + Fitvids, which makes all video embeds responsive -->
    <script
        src="https://code.jquery.com/jquery-3.2.1.min.js"
        integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
        crossorigin="anonymous">
    </script>
    <script type="text/javascript" src="/assets/js/jquery.fitvids.js"></script>
    <script type="text/javascript" src="https://demo.ghost.io/assets/js/jquery.fitvids.js?v=724281a32e"></script>


    <!-- Paginator increased to "infinit" in _config.yml -->
    <!-- if paginator.posts  -->
    <!-- <script>
        var maxPages = parseInt('');
    </script>
    <script src="/assets/js/infinitescroll.js"></script> -->
    <!-- /endif -->

    


    <!-- Add Google Analytics  -->
    <!-- Google Analytics Tracking code -->
 <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'G-6FJ2289869', 'auto');
  ga('send', 'pageview');

 </script>


    <!-- The #block helper will pull in data from the #contentFor other template files. In this case, there's some JavaScript which we only want to use in post.hbs, but it needs to be included down here, after jQuery has already loaded. -->
    
        <script>

// NOTE: Scroll performance is poor in Safari
// - this appears to be due to the events firing much more slowly in Safari.
//   Dropping the scroll event and using only a raf loop results in smoother
//   scrolling but continuous processing even when not scrolling
$(document).ready(function () {
    // Start fitVids
    var $postContent = $(".post-full-content");
    $postContent.fitVids();
    // End fitVids

    var progressBar = document.querySelector('progress');
    var header = document.querySelector('.floating-header');
    var title = document.querySelector('.post-full-title');

    var lastScrollY = window.scrollY;
    var lastWindowHeight = window.innerHeight;
    var lastDocumentHeight = $(document).height();
    var ticking = false;

    function onScroll() {
        lastScrollY = window.scrollY;
        requestTick();
    }

    function onResize() {
        lastWindowHeight = window.innerHeight;
        lastDocumentHeight = $(document).height();
        requestTick();
    }

    function requestTick() {
        if (!ticking) {
            requestAnimationFrame(update);
        }
        ticking = true;
    }

    function update() {
        var trigger = title.getBoundingClientRect().top + window.scrollY;
        var triggerOffset = title.offsetHeight + 35;
        var progressMax = lastDocumentHeight - lastWindowHeight;

        // show/hide floating header
        if (lastScrollY >= trigger + triggerOffset) {
            header.classList.add('floating-active');
        } else {
            header.classList.remove('floating-active');
        }

        progressBar.setAttribute('max', progressMax);
        progressBar.setAttribute('value', lastScrollY);

        ticking = false;
    }

    window.addEventListener('scroll', onScroll, {passive: true});
    window.addEventListener('resize', onResize, false);

    update();
});
</script>

    

    <!-- Ghost outputs important scripts and data with this tag - it should always be the very last thing before the closing body tag -->
    <!-- ghost_foot -->

</body>
</html>
